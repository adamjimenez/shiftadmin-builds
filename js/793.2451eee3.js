"use strict";(self["webpackChunkshiftadmin"]=self["webpackChunkshiftadmin"]||[]).push([[793,37],{87253:function(t,e,a){a.r(e),a.d(e,{default:function(){return j}});var i=a(56768),l=a(24232),o=a(13892),n=a(4189),s=a(91606),u=a(30697),r=a(16009),c=a(93745),d=a(68272),g=a(74025),m=a(91772),p=a(69915),f=a(57254),h=a(4913),v=a(97505),k=a(88249),y=a(55263),b=a(20105),_=a(51146),D=a(10381),C=a(76686);const F={key:1,class:"w-100"},w={class:"pa-5 d-flex flex-column",style:{height:"1px",overflow:"auto","flex-grow":"1"}},X={key:0},A=["href"],x=["href"],E=["href"],L=["href"],W={key:5,class:"mx-5"},P={key:6},V=["href"],I=["src"],S={key:8},U=["src"],$=["innerHTML"],R={key:11},M={key:0},H=["innerHTML"],K={key:0};function O(t,e,a,O,T,Q){const B=(0,i.g2)("ListButtons"),Y=(0,i.g2)("list-page");return(0,i.uX)(),(0,i.Wv)(n.J,{class:"d-flex flex-column"},{default:(0,i.k6)((()=>[(0,i.bF)(_.i,{color:"secondary",class:"w-100 d-flex"},{default:(0,i.k6)((()=>[t.back?((0,i.uX)(),(0,i.Wv)(o.D,{key:0,title:"Back",icon:"mdi-arrow-left",to:t.back,color:"grey-lighten-1",variant:"text"},null,8,["to"])):(0,i.Q3)("",!0),"summary"===t.tab?((0,i.uX)(),(0,i.CE)("span",F,[(0,i.bF)(o.D,{title:"Edit",icon:"mdi-pencil",color:"grey-lighten-1",to:"edit",variant:"text"}),t.data["deleted"]>0?((0,i.uX)(),(0,i.Wv)(o.D,{key:0,title:"Restore",icon:"mdi-delete-restore",color:"success",onClick:Q.restoreItem,variant:"text"},null,8,["onClick"])):((0,i.uX)(),(0,i.Wv)(o.D,{key:1,title:"Delete",icon:"mdi-delete",color:"grey-lighten-1",onClick:Q.deleteItem,variant:"text"},null,8,["onClick"])),(0,i.bF)(o.D,{title:"Logs",icon:"mdi-text",color:"grey-lighten-1",onClick:Q.openLogs,variant:"text"},null,8,["onClick"]),t.data.admin>1?((0,i.uX)(),(0,i.Wv)(o.D,{key:2,title:"Privileges",icon:"mdi-account-key",color:"grey-lighten-1",onClick:Q.openPrivileges,variant:"text"},null,8,["onClick"])):(0,i.Q3)("",!0),Q.buttons.length?((0,i.uX)(),(0,i.Wv)(k.q,{key:3},{activator:(0,i.k6)((({props:t})=>[(0,i.bF)(o.D,(0,i.v6)(t,{icon:"mdi-dots-vertical",color:"grey-lighten-1",variant:"text"}),null,16)])),default:(0,i.k6)((()=>[(0,i.bF)(p.x8,null,{default:(0,i.k6)((()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(Q.buttons,((t,e)=>((0,i.uX)(),(0,i.Wv)(f.g,{key:e,value:e,onClick:e=>Q.customButton(t)},{default:(0,i.k6)((()=>[(0,i.bF)(h.U,null,{default:(0,i.k6)((()=>[(0,i.eW)((0,l.v_)(t.label),1)])),_:2},1024)])),_:2},1032,["value","onClick"])))),128))])),_:1})])),_:1})):(0,i.Q3)("",!0)])):((0,i.uX)(),(0,i.Wv)(B,{key:2,selected:t.selected,section:t.tab,onChangeFields:Q.changeFields,parentsection:t.section,parentid:t.id,sortable:Q.isSortable,onAction:Q.actionHandler,data:t.buttonData},null,8,["selected","section","onChangeFields","parentsection","parentid","sortable","onAction","data"]))])),_:1}),(0,i.Lk)("div",w,[(0,i.bF)(D.h,{modelValue:t.tab,"onUpdate:modelValue":e[0]||(e[0]=e=>t.tab=e),style:{"min-height":"50px"}},{default:(0,i.k6)((()=>[(0,i.bF)(C.U,{value:"summary"},{default:(0,i.k6)((()=>[(0,i.eW)("Summary")])),_:1}),a.vars.subsections&&a.vars.subsections[t.section]?.length?((0,i.uX)(!0),(0,i.CE)(i.FK,{key:0},(0,i.pI)(a.vars?.subsections[t.section],(t=>((0,i.uX)(),(0,i.Wv)(C.U,{key:t,value:t},{default:(0,i.k6)((()=>[(0,i.eW)((0,l.v_)(t),1)])),_:2},1032,["value"])))),128)):(0,i.Q3)("",!0)])),_:1},8,["modelValue"]),"summary"===t.tab?((0,i.uX)(),(0,i.Wv)(n.J,{key:0,"min-width":"600",style:{overflow:"auto"}},{default:(0,i.k6)((()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(t.fields,((e,a,n)=>((0,i.uX)(),(0,i.CE)(i.FK,{key:n},[t.data[e.column]&&!["password"].includes(e.type)&&(!["file","select","select_parent","combo"].includes(e.type)||t.data[e.column]>0)?((0,i.uX)(),(0,i.CE)("div",X,[(0,i.bF)(s.r,null,{default:(0,i.k6)((()=>[(0,i.eW)((0,l.v_)(Q.formatString(a)),1)])),_:2},1024),(0,i.bF)(u.O,{title:a},{default:(0,i.k6)((()=>["email"===e.type?((0,i.uX)(),(0,i.CE)("a",{key:0,href:"mailto:"+t.data[e.column]},(0,l.v_)(t.data[e.column]),9,A)):"tel"===e.type?((0,i.uX)(),(0,i.CE)("a",{key:1,href:"tel:"+t.data[e.column]},(0,l.v_)(t.data[e.column]),9,x)):"url"===e.type?((0,i.uX)(),(0,i.CE)("a",{key:2,href:t.data[e.column],target:"_blank"},(0,l.v_)(t.data[e.column]),9,E)):"coords"===e.type?((0,i.uX)(),(0,i.CE)("a",{key:3,href:"https://www.google.com/maps/search/?api=1&query="+t.data[e.column],target:"_blank"},(0,l.v_)(t.data[e.column]),9,L)):["select","select_parent","combo"].includes(e.type)?((0,i.uX)(),(0,i.Wv)(o.D,{key:4,to:Q.getSelectLink(a,t.data[e.column]),variant:"text"},{default:(0,i.k6)((()=>[(0,i.eW)((0,l.v_)(t.data[e.column+"_label"]?t.data[e.column+"_label"]:t.data[e.column]),1)])),_:2},1032,["to"])):"select_multiple"===e.type?((0,i.uX)(),(0,i.CE)("div",W,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(t.data[e.column],((n,s,u)=>((0,i.uX)(),(0,i.Wv)(o.D,{key:u,to:Q.getSelectLink(a,n),variant:"text"},{default:(0,i.k6)((()=>[(0,i.eW)((0,l.v_)(Q.getOption(t.options[e.column],n)?.title),1)])),_:2},1032,["to"])))),128))])):"rating"===e.type?((0,i.uX)(),(0,i.CE)("span",P,[(0,i.bF)(y.e,{modelValue:t.data[e.column],"onUpdate:modelValue":a=>t.data[e.column]=a,length:5,size:32,readonly:""},null,8,["modelValue","onUpdate:modelValue"])])):["file","upload"].includes(e.type)?((0,i.uX)(),(0,i.CE)("a",{key:7,href:t.apiRoot+"?cmd=file&f="+t.data[e.column],target:"_blank"},[(0,i.Lk)("img",{src:t.apiRoot+"?cmd=file&f="+t.data[e.column]+"&w=320&h=240"},null,8,I),(0,i.Lk)("div",null,(0,l.v_)(t.data[e.column]),1)],8,V)):["files","uploads"].includes(e.type)?((0,i.uX)(),(0,i.CE)("div",S,[(0,i.bF)(d.n,null,{default:(0,i.k6)((()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(t.data[e.column],(e=>((0,i.uX)(),(0,i.Wv)(g.q,{key:e,src:t.apiRoot+"?cmd=file&f="+e},null,8,["src"])))),128))])),_:2},1024)])):"upload"===e.type?((0,i.uX)(),(0,i.CE)("img",{key:9,src:t.apiRoot+"?cmd=upload&f="+t.data[e.column]+"&w=320&h=240"},null,8,U)):"editor"===e.type?((0,i.uX)(),(0,i.CE)("div",{key:10,innerHTML:t.data[e.column]},null,8,$)):((0,i.uX)(),(0,i.CE)("span",R,[(0,i.Lk)("span",null,(0,l.v_)(Q.formatData(t.data[e.column],e.type)),1),"dob"===e.type?((0,i.uX)(),(0,i.CE)("span",M,"("+(0,l.v_)(Q.age(t.data[e.column]))+")",1)):(0,i.Q3)("",!0)]))])),_:2},1032,["title"])])):(0,i.Q3)("",!0)],64)))),128))])),_:1})):((0,i.uX)(),(0,i.Wv)(Y,{key:1,section:t.tab,parentsection:t.section,parentid:t.id,hidebuttons:"",ref:"listPage",onLoaded:Q.loaded},null,8,["section","parentsection","parentid","onLoaded"]))]),(0,i.bF)(m.p,{modelValue:t.logsDialog,"onUpdate:modelValue":e[2]||(e[2]=e=>t.logsDialog=e),"max-width":"600",scrollable:""},{default:(0,i.k6)((()=>[(0,i.bF)(n.J,{title:"Logs",loading:t.loadingLogs},{default:(0,i.k6)((()=>[(0,i.bF)(p.x8,null,{default:(0,i.k6)((()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(t.logs,(a=>((0,i.uX)(),(0,i.Wv)(f.g,{key:a.id,class:"unclamp mb-3"},{default:(0,i.k6)((()=>[(0,i.bF)(h.U,null,{default:(0,i.k6)((()=>[(0,i.eW)((0,l.v_)(Q.formatString(a.task))+" on "+(0,l.v_)(Q.formatDateTime(a.date)),1)])),_:2},1024),(0,i.bF)(v.w,null,{default:(0,i.k6)((()=>[(0,i.Lk)("div",{innerHTML:a.details,style:{"white-space":"pre"}},null,8,H)])),_:2},1024),a.user>0?((0,i.uX)(),(0,i.CE)("div",K,[(0,i.bF)(o.D,{variant:"text",to:"../../users/"+a.user,onClick:e[1]||(e[1]=e=>t.logsDialog=!1)},{default:(0,i.k6)((()=>[(0,i.eW)((0,l.v_)(a.name?a.name:a.user),1)])),_:2},1032,["to"])])):(0,i.Q3)("",!0)])),_:2},1024)))),128))])),_:1})])),_:1},8,["loading"])])),_:1},8,["modelValue"]),(0,i.bF)(m.p,{modelValue:t.privilegesDialog,"onUpdate:modelValue":e[3]||(e[3]=e=>t.privilegesDialog=e),"max-width":"600",scrollable:""},{default:(0,i.k6)((()=>[(0,i.bF)(n.J,{title:"Privileges",loading:t.loadingPrivileges},{default:(0,i.k6)((()=>[(0,i.bF)(p.x8,null,{default:(0,i.k6)((()=>[(0,i.bF)(r.m,null,{default:(0,i.k6)((()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(t.sections,(e=>((0,i.uX)(),(0,i.Wv)(b.d4,{key:e,label:e,modelValue:t.privileges[e].access,"onUpdate:modelValue":a=>t.privileges[e].access=a,items:t.accessOptions},null,8,["label","modelValue","onUpdate:modelValue","items"])))),128))])),_:1})])),_:1}),(0,i.bF)(c.S,null,{default:(0,i.k6)((()=>[(0,i.bF)(o.D,{onClick:Q.savePrivileges,color:"primary",variant:"flat"},{default:(0,i.k6)((()=>[(0,i.eW)("Save")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["loading"])])),_:1},8,["modelValue"])])),_:1})}a(44114),a(14603),a(47566),a(98721);var T=a(74300),Q=a(27274),B=a(1808),Y=a(5089),J={components:{ListPage:B["default"],ListButtons:Y.A},props:{vars:null},data:function(){return{data:{},fields:[],section:"",id:0,tab:"summary",logsDialog:!1,loadingLogs:!1,logs:[],privilegesDialog:!1,loadingPrivileges:!1,privileges:{},sections:[],selected:[],headers:[],activeHeaders:[],accessOptions:[{value:0,title:"None"},{value:1,title:"Read"},{value:2,title:"Write"},{value:3,title:"Full"}],apiRoot:"",options:[],back:"../",buttonData:{}}},methods:{fetchData:async function(){let t={cmd:"get",section:this.section,id:this.id};const e=await T.A.post("?section="+this.section,t);if(!e)return!1;let a=e.data.fields;if(this.$emit("changeFields",Object.values(a)),e.data.data){let t=e.data.data;this.options=await Q.A.getAllOptions(a,this.vars,this.section,t);for(const[,e]of Object.entries(a))"password"===e.type?t[e.column]="":"checkbox"===e.type?t[e.column]=t[e.column]=t[e.column]>0:"select_multiple"!==e.type||Array.isArray(t[e.column])||(t[e.column]=[]);this.data=t}else this.data={};this.fields=e.data.fields;let i=this.vars?.branding?.title?this.vars.branding.title:"ADMIN";document.title=i+" | "+this.section+" | "+this.id;const l=new URLSearchParams(window.location.search),o=l.get("parentsection");if(o){const t=l.get("parentid");this.back="../../"+o+"/"+t+"/"}a.id||(this.back="")},openLogs:async function(){this.logsDialog=!0,this.loadingLogs=!0;const t=await T.A.get("?cmd=logs&section="+this.section+"&id="+this.id);if(this.loadingLogs=!1,!t)return!1;this.logs=t.data.data},openPrivileges:async function(){if(!["Business"].includes(Q.A.getEdition()))return void this.$router.push(Q.A.base()+"upgrade");this.privilegesDialog=!0,this.loadingPrivileges=!0;const t=await T.A.get("?cmd=privileges&user_id="+this.id);if(this.loadingPrivileges=!1,!t)return!1;this.privileges=t.data.privileges,this.sections=t.data.sections},savePrivileges:async function(){this.loadingPrivileges=!0,await T.A.post("?cmd=privileges&user_id="+this.id,{privileges:this.privileges}),this.privilegesDialog=!1},restoreItem:async function(){if(!confirm("Are you sure you want to restore?"))return;let t={section:this.section,id:this.id};await T.A.post("?cmd=restore&section="+this.section,t),this.fetchData()},deleteItem:async function(){if(!confirm("Are you sure to delete?"))return;let t={section:this.section,ids:[this.id]};await T.A.post("?cmd=delete&section="+this.section,t),this.$router.push("../"+this.section)},changeFields:function(){this.$refs["listPage"].dialog=!0},actionHandler:function(){this.$refs["listPage"].actionHandler(...arguments)},age:function(t){const e=new Date,a=new Date(t);if(isNaN(a.getTime()))return"Invalid date format. Please use YYYY-MM-DD.";let i=e.getFullYear()-a.getFullYear();const l=e.getMonth()-a.getMonth(),o=e.getDate()-a.getDate();return(l<0||0===l&&o<0)&&i--,i},getSelectLink:function(t,e){let a=this.vars.options[t.replaceAll("_"," ")];if("string"===typeof a)return"../../"+a.replaceAll("_"," ")+"/"+e+"/"},customButton:async function(t){let e={cmd:"button",button:t.id,section:this.section,ids:[this.id]};this.loading=!0;const a=await T.A.post("?cmd=button&section="+this.section,e);this.loading=!1,a.data.error&&alert(a.data.error),a.data.result?.redirect?a.data.result?.target?window.open(a.data.result.redirect):location.href=a.data.result.redirect:await this.fetchData()},getOption:function(t,e){return t.find((t=>t.value===e))},formatData:function(t,e){return Q.A.formatData(t,e)},formatDateTime:function(t){return Q.A.formatDateTime(t)},formatString:function(t){return Q.A.formatString(t)},loaded:function(){let t=this.$refs["listPage"]?.buttonData;this.buttonData=t||{}}},computed:{buttons:function(){let t=[];return this.vars?.buttons?.forEach(((e,a)=>{"view"===e.page&&e.section===this.section&&(e.id=a,t.push(e))})),t},isSortable:function(){return this.$refs["listPage"]?.isSortable}},watch:{$route(){this.section=this.$route.params.section,this.id=this.$route.params.id,this.tab="summary",this.fetchData()},vars:function(){this.fetchData()}},async mounted(){this.section=this.$route.params.section,this.id=this.$route.params.id,this.apiRoot=T.A.getApiRoot(),this.vars.sections&&this.fetchData()}},N=a(71241);const q=(0,N.A)(J,[["render",O],["__scopeId","data-v-ec96a49a"]]);var j=q}}]);
//# sourceMappingURL=793.2451eee3.js.map