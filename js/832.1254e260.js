"use strict";(self["webpackChunkshiftadmin"]=self["webpackChunkshiftadmin"]||[]).push([[832],{71832:function(e,t,a){a.r(t),a.d(t,{default:function(){return G}});a(44114),a(64979),a(71678);var l=a(56768),o=a(24232),i=a(45130),n=a(90144),s=a(47664),r=a(74300),u=a(27274),c=a(31969),d=a(13892),h=a(4189),m=a(93745),p=a(47697),f=a(91772),b=a(78351),g=a(67020),v=a(57254),y=a(43948);function k(e,t,a,o,i,n){return(0,l.uX)(),(0,l.CE)("span",null,[(0,l.bF)(v.g,{title:"File uploads","prepend-icon":"mdi-file-upload",onClick:n.open},null,8,["onClick"]),(0,l.bF)(f.p,{modelValue:e.dialog,"onUpdate:modelValue":t[3]||(t[3]=t=>e.dialog=t),scrollable:""},{default:(0,l.k6)((()=>[(0,l.bF)(h.J,null,{default:(0,l.k6)((()=>[e.error?((0,l.uX)(),(0,l.Wv)(c.l,{key:0,title:e.error,type:"error"},null,8,["title"])):(0,l.Q3)("",!0),(0,l.bF)(m.S,null,{default:(0,l.k6)((()=>[(0,l.bF)(d.D,{title:"Create folder",icon:"mdi-folder-outline",onClick:n.createFolder},null,8,["onClick"]),(0,l.bF)(d.D,{title:"Delete",icon:"mdi-delete",disabled:0===e.selected.length,onClick:n.deleteItems},null,8,["disabled","onClick"]),(0,l.bF)(b.f,{modelValue:e.file,"onUpdate:modelValue":[t[0]||(t[0]=t=>e.file=t),n.uploadFile],"prepend-icon":"mdi-upload","hide-details":"",class:"hide-input mx-3"},null,8,["modelValue","onUpdate:modelValue"]),(0,l.bF)(d.D,{title:"Up level",disabled:"/"===e.path,icon:"mdi-arrow-up",onClick:n.upLevel},null,8,["disabled","onClick"]),(0,l.bF)(y.W,{modelValue:e.path,"onUpdate:modelValue":t[1]||(t[1]=t=>e.path=t),"hide-details":"",readonly:"",density:"compact"},null,8,["modelValue"])])),_:1}),(0,l.bF)(p.Py,{items:e.items,headers:e.headers,"show-select":"",modelValue:e.selected,"onUpdate:modelValue":t[2]||(t[2]=t=>e.selected=t),"onClick:row":n.rowClick,loading:e.loading},{["item.thumb"]:(0,l.k6)((({item:t})=>[t.thumb?((0,l.uX)(),(0,l.Wv)(g.y,{key:0,src:e.apiRoot+"?cmd=file&f="+t.id,style:{"max-width":"160px","max-height":"120px"}},null,8,["src"])):(0,l.Q3)("",!0)])),_:2},1032,["items","headers","modelValue","onClick:row","loading"])])),_:1})])),_:1},8,["modelValue"])])}var F={data:function(){return{column:"",dialog:!1,items:[],path:"/",headers:[{title:"Name",value:"name"},{title:"Thumb",value:"thumb"}],apiRoot:"",selected:[],loading:!1,file:[],error:""}},methods:{fetchData:async function(){this.loading=!0;const e=await r.A.get("?cmd=uploads&path="+this.path);e.data.error&&(this.error=e.data.error),this.loading=!1,this.items=e.data.items},open:function(e){this.column=e,this.dialog=!0,this.fetchData()},rowClick:function(e,t){if(t.item.leaf){let e=t.item.id;this.selectFile(e)}else this.path=t.item.id+"/",this.fetchData()},selectFile:function(e){"function"===typeof this.column?(e="/uploads"+e,this.column(e,{title:e})):this.$emit("fileSelected",{value:e.substr(1),column:this.column}),this.dialog=!1},upLevel:function(){let e=this.path.substr(0,this.path.length-1).lastIndexOf("/");-1!==e&&(this.path=this.path.substr(0,e+1)),this.fetchData()},createFolder:async function(){let e=prompt("Folder name");if(!e)return;this.loading=!0;const t=await r.A.post("?cmd=uploads&path="+this.path,{createFolder:e});this.loading=!1,t.data.error&&(this.error=t.data.error),this.fetchData()},deleteItems:async function(){if(!confirm("Are you sure?"))return;this.loading=!0;const e=await r.A.post("?cmd=uploads&path="+this.path,{delete:this.selected});this.loading=!1,e.data.error&&(this.error=e.data.error),this.fetchData()},uploadFile:async function(){console.log(this.file);const e=new FormData;this.file.forEach((function(t){console.log("File details:",t),e.append("file",t)})),this.loading=!0;const t=await r.A.post("?cmd=uploads&path="+this.path,e,{headers:{"Content-Type":"multipart/form-data"}});this.loading=!1,t.data?.error&&alert(t.data?.error),this.selectFile(t.data.file)}},async mounted(){this.apiRoot=r.A.getApiRoot()}},w=a(71241);const V=(0,w.A)(F,[["render",k]]);var D=V,_=a(2543),C=a(68353),S=a(73416),W=a(69915),X=a(88249);function U(e,t,a,n,s,r){return(0,l.uX)(),(0,l.Wv)(X.q,{modelValue:e.opened,"onUpdate:modelValue":t[2]||(t[2]=t=>e.opened=t)},{activator:(0,l.k6)((({props:e})=>[(0,l.bF)(d.D,(0,l.v6)({color:"primary"},e,{onClick:t[0]||(t[0]=(0,i.D$)((()=>{}),["stop"])),onMousedown:t[1]||(t[1]=(0,i.D$)((()=>{}),["stop"]))}),{default:(0,l.k6)((()=>[(0,l.bF)(S.y,{color:"primary"},{default:(0,l.k6)((()=>[(0,l.eW)((0,o.v_)(a.user?.initials?a.user.initials:"??"),1)])),_:1})])),_:2},1040)])),default:(0,l.k6)((()=>[(0,l.bF)(W.x8,null,{default:(0,l.k6)((()=>[(0,l.bF)(v.g,null,{default:(0,l.k6)((()=>[(0,l.eW)((0,o.v_)(a.user.name),1)])),_:1}),(0,l.bF)(v.g,{onClick:r.logout,title:"Logout","prepend-icon":"mdi-logout"},null,8,["onClick"])])),_:1})])),_:1},8,["modelValue"])}var $={props:{user:null},data:function(){return{opened:!1}},methods:{logout:async function(){await r.A.post("?cmd=logout"),this.$router.push(u.A.base()+"login")}}};const A=(0,w.A)($,[["render",U]]);var x=A,P=a(96450),R=a(30249),Q=a(58332),E=a(3462),O=a(91606),I=a(30697),j=a(20396),L=a(7511),T=a(41720),M=a(79669),q=a(4529),K=a(98477),N=a(70373);const J={key:2,class:"text-align-center w-100 d-flex flex-row justify-center"},B={name:"GenieAdmin",components:{FileUploads:D,SearchField:_.A,AccountButton:x},data:function(){return{section:"",search:null,searchItems:[],drawer:!0,rail:!0,vars:{},data:{},user:{},advancedDialog:!1,fields:[],params:{func:{}},searchParams:{},searchable:["checkbox","combo","date","datetime","decimal","deleted","email","id","int","page_name","rating","select","select_parent","select_multiple","tel","text","timestamp"],fileSelected:{},fullScreen:!1,display:{},searchFocussed:!1}},methods:{afterSelection:function(e){"object"===typeof e&&null!==e&&this.$router.push(this.base+"section/"+this.section+"/"+e.value+"/")},updateSearch:async function(){null!==this.search&&"object"===typeof this.search||(this.section=this.$route.params.section,this.searchParams={s:this.search})},updateFunc:function(e,t){this.params.func[e]=t},quickSearch:function(){this.searchParams={s:this.search}},doSearch:function(){let e=structuredClone(this.params);for(const[t,a]of Object.entries(e))""===a&&delete e[t];for(const[t,a]of Object.entries(e.func))""!==a&&"undefined"!==typeof e[t]||delete e.func[t];this.searchParams=e,this.advancedDialog=!1},saveSearch:async function(){let e=prompt("Name this filter");if(!e)return;let t={save:1,label:e,section:this.section,conditions:this.searchParams};await r.A.post("?cmd=filters",t),this.advancedDialog=!1,this.fetchData()},advancedSearch:async function(){this.params.func||(this.params.func={}),this.advancedDialog=!0},changeFields:function(e){this.fields=e},fetchData:async function(){let e={};try{e=await r.A.get("?cmd=config")}catch(o){console.log(o)}let t=e.data;if(t?.vars)for(let[i,n]of Object.entries(t.vars.subsections))n.forEach(((e,a)=>{"string"===typeof e&&(t.vars.subsections[i][a]={title:this.formatString(e),subsection:e})}));this.vars=t?.vars,this.user=t?.user;let a={primary:"#007bff",secondary:"#303641"};this.$vuetify.theme.themes.light.colors={...this.$vuetify.theme.themes.light.colors,...a,...this.vars?.branding?.colors},this.$vuetify.theme.themes.dark.colors={...this.$vuetify.theme.themes.dark.colors,...a,...this.vars?.branding?.colors};let l=this.vars?.branding?.title?this.vars.branding.title:"ADMIN";document.title=l},deleteFilter:async function(e){confirm("Are you sure?")&&(await r.A.post("?cmd=filters",{delete:e}),this.fetchData())},chooseFileUpload:function(e){this.$refs["fileUploads"].open(e)},fileSelectedHandler:function(e){this.fileSelected=e},message:function(e){console.log(e),"boolean"===typeof e.fullScreen&&(this.fullScreen=e.fullScreen)},formatString:function(e){return u.A.formatString(e)},updateCount:function(e){this.vars?.menu?.forEach((t=>{t.children?.forEach((t=>{location.href.endsWith(t.to)&&(t.count=e.total)}))}));let t=[];e.data.forEach((e=>{let a="";for(const[t,l]of Object.entries(e))"id"!==t&&(a&&(a+=", "),a+=l);t.push({value:e.id,title:a})})),this.searchItems=t}},watch:{$route(){let e=this.$route.query;e&&(this.params=e,this.searchParams=e),this.$route.params.section!==this.section&&(this.section=this.$route.params.section,this.search=this.params.s)},searchParams:function(e){let t=e;delete t.parentsection,delete t.parentid,Object.values(e).length&&this.$router.push({path:this.base+"section/"+this.$route.params.section,query:e})},mobile(e){this.rail=!e,this.drawer=!e},rail(e){localStorage.rail=e},advancedDialog(e){!1===e&&(this.searchFocussed=!1)}},computed:{base(){return u.A.base()},searchParamCount(){return Object.keys(this.searchParams).filter((e=>!["func","s"].includes(e)&&"undefined"!==typeof this.searchParams[e])).length},edition(){return u.A.getEdition()},mobile:function(){return this.display},showSearch:function(){return this.fields.find((e=>"id"===e.type))||!1}},async mounted(){const{mobile:e}=(0,C._F)();this.display=e,await this.$router.isReady();let t=this.$route.query;t&&(this.params=t,this.searchParams=t,this.search=this.params.s),this.$route.params.section&&(this.section=this.$route.params.section),await this.fetchData(),"false"===localStorage.rail&&(this.rail=!1)}};var Y=Object.assign(B,{setup(e){const t=(0,s.DP)();return window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",(e=>{const a=e.matches?"dark":"light";t.global.name.value=a})),(e,t)=>{const a=(0,l.g2)("router-view");return(0,l.uX)(),(0,l.Wv)(P.E,{class:(0,o.C4)(e.mobile?"mobile":"desktop")},{default:(0,l.k6)((()=>[(0,l.bF)(R.z,{color:"secondary"},{default:(0,l.k6)((()=>[e.mobile&&e.showSearch?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(Q.Z,{key:0,variant:"text",color:"grey-lighten-1",onClick:t[0]||(t[0]=(0,i.D$)((t=>{e.mobile?e.drawer=!e.drawer:e.rail=!e.rail}),["stop"]))})),e.mobile?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(d.D,{key:1,to:e.base,variant:"plain"},{default:(0,l.k6)((()=>[(0,l.eW)((0,o.v_)(e.vars?.branding?.title?e.vars.branding.title:"Admin"),1)])),_:1},8,["to"])),e.showSearch?((0,l.uX)(),(0,l.CE)("div",J,[e.section&&e.fields.length?((0,l.uX)(),(0,l.Wv)(j.A,{key:0,modelValue:e.search,"onUpdate:modelValue":[t[6]||(t[6]=t=>e.search=t),e.afterSelection],items:e.searchItems,"onUpdate:search":e.updateSearch,onKeydown:(0,i.jR)(e.quickSearch,["enter"]),ref:"autocomplete","hide-details":"","hide-no-data":"","single-line":"",rounded:"",variant:"solo-filled","no-filter":"",class:"mx-5",style:{"max-width":"800px"},label:"Search "+e.section,placeholder:"Search "+e.section,onFocus:t[7]||(t[7]=t=>e.searchFocussed=!0)},{"prepend-inner":(0,l.k6)((()=>[e.searchFocussed?((0,l.uX)(),(0,l.Wv)(M.w,{key:0,icon:"mdi:mdi-arrow-left",onClick:t[1]||(t[1]=(0,i.D$)((t=>e.searchFocussed=!1),["stop"])),onMousedown:t[2]||(t[2]=(0,i.D$)((()=>{}),["stop"]))})):e.mobile?((0,l.uX)(),(0,l.Wv)(Q.Z,{key:1,color:"grey-lighten-1",onClick:t[3]||(t[3]=(0,i.D$)((t=>{e.mobile?e.drawer=!e.drawer:e.rail=!e.rail}),["stop"])),onMousedown:t[4]||(t[4]=(0,i.D$)((()=>{}),["stop"]))})):((0,l.uX)(),(0,l.Wv)(M.w,{key:2,icon:"mdi:mdi-magnify"}))])),"append-inner":(0,l.k6)((()=>[e.mobile&&!e.searchFocussed?((0,l.uX)(),(0,l.Wv)(x,{key:0,user:e.user},null,8,["user"])):((0,l.uX)(),(0,l.Wv)(d.D,{key:1,color:"grey-lighten-1",onMousedown:t[5]||(t[5]=(0,i.D$)((()=>{}),["stop"])),onClick:(0,i.D$)(e.advancedSearch,["stop"]),disabled:0===e.fields.length,icon:""},{default:(0,l.k6)((()=>[e.searchParamCount>0?((0,l.uX)(),(0,l.Wv)(E.Q,{key:0,content:e.searchParamCount,color:"info"},{default:(0,l.k6)((()=>[(0,l.bF)(M.w,{icon:"mdi-tune"})])),_:1},8,["content"])):((0,l.uX)(),(0,l.Wv)(M.w,{key:1,icon:"mdi-tune"}))])),_:1},8,["onClick","disabled"]))])),_:1},8,["modelValue","items","onUpdate:search","onUpdate:modelValue","onKeydown","label","placeholder"])):(0,l.Q3)("",!0)])):(0,l.Q3)("",!0),e.mobile&&e.showSearch?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(T.h,{key:3})),e.mobile&&e.showSearch?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(x,{key:4,user:e.user},null,8,["user"]))])),_:1}),(0,l.bF)(N.e,{modelValue:e.drawer,"onUpdate:modelValue":t[8]||(t[8]=t=>e.drawer=t),rail:e.rail,"expand-on-hover":"",permanent:!e.mobile,color:"secondary"},{default:(0,l.k6)((()=>[(0,l.bF)(W.x8,null,{default:(0,l.k6)((()=>[e.mobile?((0,l.uX)(),(0,l.Wv)(v.g,{key:0,to:e.base,"prepend-icon":"mdi-home"},{default:(0,l.k6)((()=>[(0,l.eW)((0,o.v_)(e.vars?.branding?.title?e.vars.branding.title:"Admin"),1)])),_:1},8,["to"])):(0,l.Q3)("",!0),"Business"!==e.edition?((0,l.uX)(),(0,l.Wv)(v.g,{key:1,title:"Upgrade","prepend-icon":"mdi-rocket-launch",to:e.base+"upgrade","base-color":"red"},null,8,["to"])):(0,l.Q3)("",!0),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.vars?.menu,(t=>((0,l.uX)(),(0,l.CE)("div",{key:t},[t.children?((0,l.uX)(),(0,l.Wv)(q.K,{key:0,"prepend-icon":t.icon?t.icon:"mdi-minus",value:t.title},{activator:(0,l.k6)((({props:e})=>[(0,l.bF)(v.g,(0,l.v6)(e,{title:t.title}),null,16,["title"])])),default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(t.children,(t=>((0,l.uX)(),(0,l.Wv)(v.g,{key:t.to,title:t.title,value:t.to,to:t.target_blank?t.to:e.base+t.to,target:t.target_blank?"_blank":""},{prepend:(0,l.k6)((()=>[t.count>0?((0,l.uX)(),(0,l.Wv)(E.Q,{key:0,content:parseInt(t.count).toLocaleString(),color:"error"},{default:(0,l.k6)((()=>[(0,l.bF)(M.w,{icon:t.icon?t.icon:"mdi-minus"},null,8,["icon"])])),_:2},1032,["content"])):((0,l.uX)(),(0,l.Wv)(M.w,{key:1,icon:t.icon?t.icon:"mdi-minus"},null,8,["icon"]))])),append:(0,l.k6)((()=>[t.filter_id?((0,l.uX)(),(0,l.Wv)(d.D,{key:0,icon:"mdi-delete",onClick:(0,i.D$)((a=>e.deleteFilter(t.filter_id)),["stop"]),variant:"text",size:"x-small"},null,8,["onClick"])):(0,l.Q3)("",!0)])),_:2},1032,["title","value","to","target"])))),128))])),_:2},1032,["prepend-icon","value"])):((0,l.uX)(),(0,l.Wv)(v.g,{key:1,title:t.title,value:t.to,to:t.target_blank?t.to:e.base+t.to,target:t.target_blank?"_blank":""},{prepend:(0,l.k6)((()=>[t.count>0?((0,l.uX)(),(0,l.Wv)(E.Q,{key:0,content:parseInt(e.child.count).toLocaleString(),color:"error"},{default:(0,l.k6)((()=>[(0,l.bF)(M.w,{icon:t.icon?t.icon:"mdi-minus"},null,8,["icon"])])),_:2},1032,["content"])):((0,l.uX)(),(0,l.Wv)(M.w,{key:1,icon:t.icon?t.icon:"mdi-minus"},null,8,["icon"]))])),_:2},1032,["title","value","to","target"]))])))),128)),(0,l.bF)(v.g,{title:"Reports","prepend-icon":"mdi-chart-line",to:e.base+"reports"},null,8,["to"]),1===e.user?.admin||e.user?.privileges?.uploads>0?((0,l.uX)(),(0,l.Wv)((0,n.R1)(D),{key:2,ref:"fileUploads",onFileSelected:e.fileSelectedHandler},null,8,["onFileSelected"])):(0,l.Q3)("",!0),1===e.user?.admin?((0,l.uX)(),(0,l.Wv)(v.g,{key:3,title:"Configure","prepend-icon":"mdi-cog",to:e.base+"configure"},null,8,["to"])):(0,l.Q3)("",!0)])),_:1})])),_:1},8,["modelValue","rail","permanent"]),(0,l.bF)(K.Y,{class:"d-flex flex-column align-center justify-center"},{default:(0,l.k6)((()=>[(0,l.bF)(a,{ref:"main",class:(0,o.C4)(["w-100 flex-grow-1",e.fullScreen?"fullScreen":""]),vars:e.vars,searchparams:e.searchParams,onChangeFields:e.changeFields,onChooseFileUpload:e.chooseFileUpload,fileSelected:e.fileSelected,onMessage:e.message,mobile:e.mobile,onSaveConfig:e.fetchData,onUpdateCount:e.updateCount},null,8,["vars","searchparams","onChangeFields","onChooseFileUpload","fileSelected","onMessage","class","mobile","onSaveConfig","onUpdateCount"])])),_:1}),(0,l.bF)(f.p,{modelValue:e.advancedDialog,"onUpdate:modelValue":t[9]||(t[9]=t=>e.advancedDialog=t),"max-width":"600",scrollable:""},{default:(0,l.k6)((()=>[(0,l.bF)(h.J,null,{default:(0,l.k6)((()=>[(0,l.bF)(O.r,null,{default:(0,l.k6)((()=>[(0,l.eW)("Search "+(0,o.v_)(e.section),1)])),_:1}),(0,l.bF)(L.G),(0,l.bF)(I.O,null,{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.fields,(t=>((0,l.uX)(),(0,l.CE)(l.FK,{key:t.type},[e.searchable.includes(t.type)?((0,l.uX)(),(0,l.Wv)(v.g,{key:0},{default:(0,l.k6)((()=>[(0,l.bF)((0,n.R1)(_.A),{column:t.column,type:t.type,optionConfig:e.vars.options,label:e.formatString(t.column),modelValue:e.params[t.column],"onUpdate:modelValue":a=>e.params[t.column]=a,func:e.params?.func[t.column],onUpdateFunc:e.updateFunc},null,8,["column","type","optionConfig","label","modelValue","onUpdate:modelValue","func","onUpdateFunc"])])),_:2},1024)):(0,l.Q3)("",!0)],64)))),128))])),_:1}),(0,l.bF)(m.S,null,{default:(0,l.k6)((()=>[(0,l.bF)(T.h),(0,l.bF)(d.D,{onClick:e.saveSearch,color:"secondary"},{default:(0,l.k6)((()=>[(0,l.eW)("Create filter")])),_:1},8,["onClick"]),(0,l.bF)(d.D,{onClick:e.doSearch,color:"primary",variant:"flat"},{default:(0,l.k6)((()=>[(0,l.eW)("Search")])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1},8,["class"])}}});const z=Y;var G=z},2543:function(e,t,a){a.d(t,{A:function(){return S}});var l=a(56768),o=a(92239),i=a(40276),n=a(20105),s=a(43948);function r(e,t,a,r,u,c){const d=(0,l.g2)("DateRange");return(0,l.uX)(),(0,l.CE)("span",null,[["checkbox","deleted"].includes(a.type)?((0,l.uX)(),(0,l.Wv)(i.a,{key:0,label:a.label,modelValue:e.value,"onUpdate:modelValue":t[0]||(t[0]=t=>e.value=t),"true-value":"1","false-value":"0"},null,8,["label","modelValue"])):["select"].includes(a.type)?((0,l.uX)(),(0,l.Wv)(n.d4,{key:1,label:a.label,items:e.options,modelValue:e.value,"onUpdate:modelValue":t[1]||(t[1]=t=>e.value=t)},null,8,["label","items","modelValue"])):["select_multiple"].includes(a.type)?((0,l.uX)(),(0,l.Wv)(n.d4,{key:2,label:a.label,items:e.options,modelValue:e.value,"onUpdate:modelValue":t[3]||(t[3]=t=>e.value=t),multiple:"",chips:""},{prepend:(0,l.k6)((()=>[(0,l.bF)(n.d4,{modelValue:e.localFunc,"onUpdate:modelValue":t[2]||(t[2]=t=>e.localFunc=t),items:["in","not in"],"hide-details":""},null,8,["modelValue"])])),_:1},8,["label","items","modelValue"])):"combo"===a.type?((0,l.uX)(),(0,l.Wv)(o.V,{key:3,label:a.label,modelValue:e.value,"onUpdate:modelValue":t[4]||(t[4]=t=>e.value=t),items:e.options,"onUpdate:search":t[5]||(t[5]=e=>c.updateCombo(e,a.column))},null,8,["label","modelValue","items"])):["date","datetime","timestamp"].includes(a.type)?((0,l.uX)(),(0,l.Wv)(d,{key:4,label:a.label,modelValue:e.value,"onUpdate:modelValue":t[6]||(t[6]=t=>e.value=t)},null,8,["label","modelValue"])):((0,l.uX)(),(0,l.Wv)(s.W,{key:5,label:a.label,modelValue:e.value,"onUpdate:modelValue":t[8]||(t[8]=t=>e.value=t),type:c.fieldType(a.type),step:c.fieldStep(a.type)},(0,l.eX)({_:2},[["id","decimal","int","rating"].includes(a.type)?{name:"prepend",fn:(0,l.k6)((()=>[(0,l.bF)(n.d4,{modelValue:e.localFunc,"onUpdate:modelValue":t[7]||(t[7]=t=>e.localFunc=t),items:["=",">","<"],"hide-details":""},null,8,["modelValue"])])),key:"0"}:void 0]),1032,["label","modelValue","type","step"]))])}var u=a(74300),c=a(27274),d=a(24232),h=a(4189),m=a(8483),p=a(43813),f=a(56756),b=a(35526),g=a(69915),v=a(57254),y=a(88249);function k(e,t,a,o,i,n){return(0,l.uX)(),(0,l.Wv)(y.q,{ref:"menu",modelValue:e.menu,"onUpdate:modelValue":t[3]||(t[3]=t=>e.menu=t),"close-on-content-click":!1,transition:"scale-transition","offset-y":""},{activator:(0,l.k6)((({props:e})=>[(0,l.bF)(s.W,(0,l.v6)({modelValue:n.dateRangeText,"onUpdate:modelValue":t[0]||(t[0]=e=>n.dateRangeText=e),label:a.label,readonly:""},e),null,16,["modelValue","label"])])),default:(0,l.k6)((()=>[(0,l.bF)(h.J,(0,d._B)((0,l.Ng)(e.$attrs)),{default:(0,l.k6)((()=>[(0,l.bF)(p.I,{class:"bg-black"},{default:(0,l.k6)((()=>[(0,l.bF)(f.L,null,{default:(0,l.k6)((()=>[(0,l.bF)(b.B,null,{default:(0,l.k6)((()=>[(0,l.bF)(g.x8,{selected:e.special,"onUpdate:selected":t[1]||(t[1]=t=>e.special=t)},{default:(0,l.k6)((()=>[(0,l.bF)(v.g,{value:"custom"},{default:(0,l.k6)((()=>[(0,l.eW)(" Custom ")])),_:1}),(0,l.bF)(v.g,{value:"last7d"},{default:(0,l.k6)((()=>[(0,l.eW)(" Last 7 days ")])),_:1}),(0,l.bF)(v.g,{value:"last28d"},{default:(0,l.k6)((()=>[(0,l.eW)(" Last 28 days ")])),_:1}),(0,l.bF)(v.g,{value:"today"},{default:(0,l.k6)((()=>[(0,l.eW)(" Today ")])),_:1}),(0,l.bF)(v.g,{value:"yesterday"},{default:(0,l.k6)((()=>[(0,l.eW)(" Yesterday ")])),_:1}),(0,l.bF)(v.g,{value:"thismonth"},{default:(0,l.k6)((()=>[(0,l.eW)(" This month ")])),_:1}),(0,l.bF)(v.g,{value:"lastmonth"},{default:(0,l.k6)((()=>[(0,l.eW)(" Last month ")])),_:1}),(0,l.bF)(v.g,{value:"thisyear"},{default:(0,l.k6)((()=>[(0,l.eW)(" This year ")])),_:1}),(0,l.bF)(v.g,{value:"lastyear"},{default:(0,l.k6)((()=>[(0,l.eW)(" Last year ")])),_:1})])),_:1},8,["selected"])])),_:1}),(0,l.bF)(m.f,{modelValue:e.value,"onUpdate:modelValue":t[2]||(t[2]=t=>e.value=t),"no-title":"","bg-color":"black",multiple:"range"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1},16)])),_:1},8,["modelValue"])}a(44114);var F={name:"DateRange",props:{modelValue:{type:[String,Array]},label:String},emits:["update:modelValue"],data:()=>({special:["custom"],menu:!1,value:[],specialPressed:!1}),methods:{parseDate:function(e){const t=new Date(e);if(!t)return;const a=t.getFullYear(),l=t.getMonth()+1,o=t.getDate(),i=l.toString().padStart(2,"0"),n=o.toString().padStart(2,"0");return`${a}-${i}-${n}`},createDateRange:async function(){let e,t=this.modelValue;const a=new Date,l=a.getFullYear(),o=a.getMonth();if("string"===typeof t){if("today"===t)e=[a];else if("yesterday"===t)e=[new Date(Date.now()-864e5)];else if("thismonth"===t)e=[new Date(l,o,1),new Date(l,o+1,0)];else if("lastmonth"===t)e=[new Date(l,o-1,1),new Date(l,o,0)];else if("thisyear"===t)e=[new Date(l,0,1),new Date(l,11,31)];else if("lastyear"===t)e=[new Date(l-1,0,1),new Date(l-1,11,31)];else{const l=t.match(/^last([0-9]+)d$/);if(l){const t=parseInt(l[1])-1;e=[new Date(Date.now()-864e5*t),a]}}e?this.special=[t]:e=[t]}else e=t;if(!e?.[0])return!1;let i=new Date(e[0]),n=new Date(e[e.length-1]),s=[];while(i<=n)s.push(new Date(i)),i.setDate(i.getDate()+1);this.specialPressed=!0,this.value=s,await this.$nextTick(),this.specialPressed=!1}},watch:{special:function(e){"custom"!==e[0]&&this.$emit("update:modelValue",e[0])},value:function(e){let t;this.specialPressed||(this.special=["custom"]),t="custom"!==this.special[0]?this.special[0]:[this.parseDate(e[0]),this.parseDate(e[e.length-1])],JSON.stringify(t)!=JSON.stringify(this.modelValue)&&this.$emit("update:modelValue",t)},modelValue:function(){this.createDateRange()}},computed:{dateRangeText(){return this.value?.[0]?this.parseDate(this.value[0])+" - "+this.parseDate(this.value[this.value.length-1]):"-"}},mounted:function(){this.createDateRange()}},w=a(71241);const V=(0,w.A)(F,[["render",k]]);var D=V,_={name:"SearchField",components:{DateRange:D},props:{modelValue:{required:!0},label:String,column:null,type:null,optionConfig:null,func:null},emits:["update:modelValue","updateFunc"],data:()=>({localFunc:null,value:null,options:[],ranges:[]}),methods:{fieldType(e){switch(e){case"dob":case"date":case"timestamp":return"date";case"int":case"decimal":return"number";case"datetime":return"datetime-local"}return["email","password","dob","time"].includes(e)?e:"text"},fieldStep(e){switch(e){case"int":return 1;case"decimal":return"0.01"}return""},updateCombo:async function(e,t){const a=await u.A.get("?cmd=autocomplete&field="+t+"&term="+e);this.options=a.data.options},getOptions:async function(){this.options=await c.A.getOptions(this.column,this.type,this.optionConfig,{})}},watch:{value:function(e){this.$emit("update:modelValue",e)},localFunc:function(e){this.$emit("updateFunc",this.column,e)},field:function(){this.getOptions()}},mounted:function(){this.getOptions(),this.value=this.modelValue,this.localFunc=this.func,this.localFunc||["decimal","int","id","rating"].includes(this.type)&&(this.localFunc="=")}};const C=(0,w.A)(_,[["render",r]]);var S=C}}]);
//# sourceMappingURL=832.1254e260.js.map