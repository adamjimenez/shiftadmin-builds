"use strict";(self["webpackChunkshiftadmin"]=self["webpackChunkshiftadmin"]||[]).push([[16],{74016:function(e,t,a){a.r(t),a.d(t,{default:function(){return _}});var s=a(56768),o=a(24232),d=a(31969),l=a(13892),i=a(4189),r=a(30697),u=a(93745),n=a(1560),h=a(41720),m=a(20477),c=a(20552),p=a(49930),g=a(43948);const k={key:0},f={key:0},v={key:1},y={key:1};function b(e,t,a,b,w,V){return(0,s.uX)(),(0,s.Wv)(n.n,{ref:"form",modelValue:e.valid,"onUpdate:modelValue":t[7]||(t[7]=t=>e.valid=t)},{default:(0,s.k6)((()=>[(0,s.bF)(i.J,{title:"GenieAdmin",subtitle:"Sign in",loading:e.loading},{default:(0,s.k6)((()=>[e.error?((0,s.uX)(),(0,s.Wv)(d.l,{key:0,type:"error",text:e.error},null,8,["text"])):(0,s.Q3)("",!0),e.message?((0,s.uX)(),(0,s.Wv)(d.l,{key:1,type:"info",text:e.message},null,8,["text"])):(0,s.Q3)("",!0),2!==e.data.code&&"invalid"!==e.error?((0,s.uX)(),(0,s.Wv)(r.O,{key:2},{default:(0,s.k6)((()=>[!1===e.data.trusted?((0,s.uX)(),(0,s.CE)("div",k,[e.data.otp_sent?((0,s.uX)(),(0,s.CE)("div",v,[t[9]||(t[9]=(0,s.Lk)("p",null," An OTP has been sent to you, please enter the code below. ",-1)),(0,s.bF)(m.C,{modelValue:e.otp,"onUpdate:modelValue":t[1]||(t[1]=t=>e.otp=t),disabled:e.loading,onFinish:V.fetchData,length:e.otpLength,autofocus:"",type:"password"},null,8,["modelValue","disabled","onFinish","length"])])):((0,s.uX)(),(0,s.CE)("div",f,[(0,s.bF)(p.$,{modelValue:e.otpMethod,"onUpdate:modelValue":t[0]||(t[0]=t=>e.otpMethod=t),class:"mb-3"},{default:(0,s.k6)((()=>[(0,s.bF)(c.i,{value:"email"},{label:(0,s.k6)((()=>[(0,s.Lk)("div",null,[t[8]||(t[8]=(0,s.Lk)("div",{class:"mb-2"},"Email me a code",-1)),(0,s.Lk)("strong",null,(0,o.v_)(e.data.email),1)])])),_:1})])),_:1},8,["modelValue"])]))])):1!==e.data.code&&2!==e.data.code&&"invalid"!==e.error?((0,s.uX)(),(0,s.CE)("div",y,[e.query.code?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(g.W,{key:0,modelValue:e.email,"onUpdate:modelValue":t[2]||(t[2]=t=>e.email=t),rules:e.usernameRules,label:"Email",required:""},null,8,["modelValue","rules"])),!e.reset||e.query.code?((0,s.uX)(),(0,s.Wv)(g.W,{key:1,type:"password",modelValue:e.password,"onUpdate:modelValue":t[3]||(t[3]=t=>e.password=t),rules:e.passwordRules,label:"Password",required:""},null,8,["modelValue","rules"])):(0,s.Q3)("",!0),e.reset||e.query.code||e.data.no_admin?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(l.D,{key:2,onClick:t[4]||(t[4]=t=>e.reset=!0),variant:"text"},{default:(0,s.k6)((()=>t[10]||(t[10]=[(0,s.eW)("Forgot password")]))),_:1}))])):(0,s.Q3)("",!0)])),_:1})):(0,s.Q3)("",!0),(0,s.bF)(u.S,null,{default:(0,s.k6)((()=>[2!==e.data.code?((0,s.uX)(),(0,s.Wv)(l.D,{key:0,color:"success",onClick:t[5]||(t[5]=e=>V.fetchData()),variant:"flat",text:V.submitText,type:"button",disabled:!V.isValid},null,8,["text","disabled"])):(0,s.Q3)("",!0),e.reset&&2!==e.data.code?((0,s.uX)(),(0,s.Wv)(l.D,{key:1,onClick:t[6]||(t[6]=t=>e.reset=!1),to:V.base+"login",variant:"text"},{default:(0,s.k6)((()=>t[11]||(t[11]=[(0,s.eW)("Cancel")]))),_:1},8,["to"])):(0,s.Q3)("",!0),(0,s.bF)(h.h),1===e.data.code?((0,s.uX)(),(0,s.Wv)(l.D,{key:2,onClick:V.logout},{default:(0,s.k6)((()=>t[12]||(t[12]=[(0,s.eW)("Logout")]))),_:1},8,["onClick"])):(0,s.Q3)("",!0)])),_:1})])),_:1},8,["loading"])])),_:1},8,["modelValue"])}a(44114);var w=a(74300),V=a(27274),W={data:()=>({valid:!0,email:"",password:"",usernameRules:[e=>!!e||"Email is required"],passwordRules:[e=>!!e||"Password is required"],loading:!1,error:"",message:"",query:{},data:{},reset:!1,otpMethod:"",otpSent:!1,otpLength:4,otp:""}),methods:{fetchData:async function(){this.query=this.$route.query,this.query.code&&(this.reset=!0);let e={cmd:"login",email:this.email,password:this.password,query:this.query,reset:this.reset,otp:this.otp,otp_method:this.otpMethod};this.error="",this.message="",this.loading=!0;const t=await w.A.post("?cmd=login",e);this.loading=!1,this.login=!1,this.data=t.data,t.data.error?this.error=t.data.error:(t.data.message&&(this.message=t.data.message),1===this.data.code&&(t.data.admin&&!1!==t.data.trusted?this.$router.push(V.A.base()):this.reset&&(this.reset=!1,this.$router.push(V.A.base()+"login"))))},logout:async function(){this.error="",this.message="",this.email="",this.password="",this.loading=!0;const e=await w.A.post("?cmd=logout");this.loading=!1,this.data=e.data,this.fetchData()}},mounted:function(){this.fetchData()},watch:{$route(){this.fetchData()}},computed:{base(){return V.A.base()},isValid(){return this.valid},submitText(){return 3===this.data.code?"Set password and login":this.reset?"Send password reminder":!1===this.data.trusted?"Next":this.data.no_admin?"Create account":"Log in"}}},C=a(71241);const X=(0,C.A)(W,[["render",b]]);var _=X}}]);
//# sourceMappingURL=16.3de302e9.js.map