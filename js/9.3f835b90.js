"use strict";(self["webpackChunkshiftadmin"]=self["webpackChunkshiftadmin"]||[]).push([[9],{5089:function(e,t,l){l.d(t,{A:function(){return g}});var a=l(56768),o=l(24232),i=l(42807),n=l(41720),s=l(35526),r=l(72164),u=l(57254),d=l(4913),c=l(88249);const p={class:"d-flex w-100 align-center"};function m(e,t,l,m,f,h){return(0,a.uX)(),(0,a.CE)("span",p,[(0,a.bF)(i.D,{variant:"text",title:"Add",icon:"mdi-plus",to:h.base+"section/"+e.internalSection+"/add"+(l.parentsection?"?parentsection="+l.parentsection+"&parentid="+l.parentid:"")},null,8,["to"]),(0,a.bF)(i.D,{variant:"text",title:"Fields",icon:"mdi-view-column",color:"grey-lighten-1",onClick:h.changeFields},null,8,["onClick"]),l.selected.length?((0,a.uX)(),(0,a.Wv)(i.D,{key:0,variant:"text",title:"Bulk Edit",icon:"mdi-pencil",color:"grey-lighten-1",onClick:t[0]||(t[0]=e=>h.doAction("openBulkEdit"))})):(0,a.Q3)("",!0),l.selected.length?((0,a.uX)(),(0,a.Wv)(i.D,{key:1,variant:"text",title:"Delete",icon:"mdi-delete",color:"grey-lighten-1",onClick:t[1]||(t[1]=e=>h.doAction("delete"))})):(0,a.Q3)("",!0),(0,a.bF)(i.D,{variant:"text",title:"Import",icon:"mdi-import",color:"grey-lighten-1",onClick:h.openImport},null,8,["onClick"]),(0,a.bF)(i.D,{variant:"text",title:"Export",icon:"mdi-export",color:"grey-lighten-1",onClick:h.exportItems},null,8,["onClick"]),l.sortable?((0,a.uX)(),(0,a.Wv)(i.D,{key:2,variant:"text",title:"Sort",icon:"mdi-sort",color:"grey-lighten-1",onClick:t[2]||(t[2]=e=>h.doAction("openSortable"))})):(0,a.Q3)("",!0),h.buttons.length?((0,a.uX)(),(0,a.Wv)(c.q,{key:3},{activator:(0,a.k6)((({props:e})=>[(0,a.bF)(i.D,(0,a.v6)({variant:"text"},e,{icon:"mdi-dots-vertical"}),null,16)])),default:(0,a.k6)((()=>[(0,a.bF)(r.x,null,{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(h.buttons,((e,t)=>((0,a.uX)(),(0,a.Wv)(u.g,{key:t,value:t,onClick:t=>h.customButton(e)},{default:(0,a.k6)((()=>[(0,a.bF)(d.U,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,o.v_)(e.label),1)])),_:2},1024)])),_:2},1032,["value","onClick"])))),128))])),_:1})])),_:1})):(0,a.Q3)("",!0),(0,a.bF)(n.h),l.mobile?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(s.B,{key:4,class:"text-grey-lighten-1 text-right"},{default:(0,a.k6)((()=>[(0,a.eW)((0,o.v_)(parseInt((l.data.page-1)*l.data.itemsPerPage+1)?.toLocaleString())+"-"+(0,o.v_)(Math.min(l.data.page*l.data.itemsPerPage,l.data.totalItems)?.toLocaleString())+" of "+(0,o.v_)(l.data.totalItems?.toLocaleString()),1)])),_:1})),(0,a.bF)(i.D,{variant:"text",icon:"mdi-chevron-left",disabled:1===l.data.page,onClick:h.prevPage},null,8,["disabled","onClick"]),(0,a.bF)(i.D,{variant:"text",icon:"mdi-chevron-right",disabled:l.data.page*l.data.itemsPerPage>=l.data.totalItems,onClick:h.nextPage},null,8,["disabled","onClick"])])}l(44114);var f={props:{vars:null,section:null,hidebuttons:Boolean,parentsection:null,parentid:null,searchparams:null,selected:null,data:null,headers:null,mobile:null,sortable:Boolean},data:function(){return{dialog:!1,selectedHeaders:[],internalSection:"",loading:!1,filter:""}},methods:{formatString:function(e){return e=e.replace(/_/g," "),e.charAt(0).toUpperCase()+e.slice(1)},doAction:async function(e){this.$emit("action",e)},exportItems:function(){this.$emit("action","export")},changeFields:function(){this.$emit("changeFields")},customButton:function(e){this.$emit("action",e)},openImport:function(){this.$emit("action","import")},prevPage:function(){this.$emit("action","prevPage")},nextPage:function(){this.$emit("action","nextPage")}},watch:{section:function(e){this.internalSection=e},filter:function(e){this.$emit("action","filter",e)}},computed:{buttons:function(){let e=[];return this.vars?.buttons?.forEach(((t,l)=>{"list"===t.page&&t.section===this.internalSection&&(t.id=l,e.push(t))})),e},base(){let e="/";return this.$route.params.base&&(e+=this.$route.params.base+"/"),e}},created(){this.internalSection=this.section?this.section:this.$route.params.section}},h=l(71241);const v=(0,h.A)(f,[["render",m]]);var g=v},17009:function(e,t,l){l.r(t),l.d(t,{default:function(){return ue}});var a=l(56768),o=l(24232),i=l(42807),n=l(4189),s=l(30697),r=l(93745),u=l(47697),d=l(84619),c=l(39692),p=l(33238),m=l(83260),f=l(46962),h=l(95682),v=l(87181),g=l(20027),b=l(15761),y=l(83962),S=l(921),k=l(6005),x=l(12858),V=l(90144),I=l(14587),F=l(51247),C=l(74600);const E=(0,I.j)({itemsLength:{type:[Number,String],required:!0},...(0,y.OZ)(),...(0,u.BE)(),...(0,d._)()},"VDataTableServer"),w=(0,F.RW)()({name:"VDataTableServer",props:E(),emits:{"update:modelValue":e=>!0,"update:page":e=>!0,"update:itemsPerPage":e=>!0,"update:sortBy":e=>!0,"update:options":e=>!0,"update:expanded":e=>!0,"update:groupBy":e=>!0},setup(e,t){let{attrs:l,slots:o}=t;const{groupBy:i}=(0,h.tG)(e),{sortBy:n,multiSort:s,mustSort:r}=(0,k.VA)(e),{page:u,itemsPerPage:I}=(0,y.lS)(e),F=(0,a.EW)((()=>parseInt(e.itemsLength,10))),{columns:E,headers:w}=(0,v.Bm)(e,{groupBy:i,showSelect:(0,V.lW)(e,"showSelect"),showExpand:(0,V.lW)(e,"showExpand")}),{items:W}=(0,g.yg)(e,E),{toggleSort:D}=(0,k._1)({sortBy:n,multiSort:s,mustSort:r,page:u}),{opened:P,isGroupOpen:$,toggleGroup:A,extractRows:B}=(0,h.Ux)({groupBy:i,sortBy:n}),{pageCount:_,setItemsPerPage:O}=(0,y.qV)({page:u,itemsPerPage:I,itemsLength:F}),{flatItems:U}=(0,h["if"])(W,i,P),{isSelected:H,select:R,selectAll:X,toggleSelect:j,someSelected:L,allSelected:N}=(0,S.C_)(e,{allItems:W,currentPage:W}),{isExpanded:z,toggleExpand:K}=(0,f.dr)(e),Q=(0,a.EW)((()=>B(W.value)));(0,b.I)({page:u,itemsPerPage:I,sortBy:n,groupBy:i,search:(0,V.lW)(e,"search")}),(0,a.Gt)("v-data-table",{toggleSort:D,sortBy:n}),(0,x.Uh)({VDataTableRows:{hideNoData:(0,V.lW)(e,"hideNoData"),noDataText:(0,V.lW)(e,"noDataText"),loading:(0,V.lW)(e,"loading"),loadingText:(0,V.lW)(e,"loadingText")}});const J=(0,a.EW)((()=>({page:u.value,itemsPerPage:I.value,sortBy:n.value,pageCount:_.value,toggleSort:D,setItemsPerPage:O,someSelected:L.value,allSelected:N.value,isSelected:H,select:R,selectAll:X,toggleSelect:j,isExpanded:z,toggleExpand:K,isGroupOpen:$,toggleGroup:A,items:Q.value.map((e=>e.raw)),internalItems:Q.value,groupedItems:U.value,columns:E.value,headers:w.value})));(0,C.C)((()=>{const t=d.O.filterProps(e),i=c.D.filterProps(e),n=p.m.filterProps(e),s=m.Z.filterProps(e);return(0,a.bF)(m.Z,(0,a.v6)({class:["v-data-table",{"v-data-table--loading":e.loading},e.class],style:e.style},s),{top:()=>o.top?.(J.value),default:()=>o.default?o.default(J.value):(0,a.bF)(a.FK,null,[o.colgroup?.(J.value),(0,a.bF)("thead",{class:"v-data-table__thead",role:"rowgroup"},[(0,a.bF)(c.D,(0,a.v6)(i,{sticky:e.fixedHeader}),o)]),o.thead?.(J.value),(0,a.bF)("tbody",{class:"v-data-table__tbody",role:"rowgroup"},[o["body.prepend"]?.(J.value),o.body?o.body(J.value):(0,a.bF)(p.m,(0,a.v6)(l,n,{items:U.value}),o),o["body.append"]?.(J.value)]),o.tbody?.(J.value),o.tfoot?.(J.value)]),bottom:()=>o.bottom?o.bottom(J.value):(0,a.bF)(d.O,t,{prepend:o["footer.prepend"]})})}))}});var W=l(91772),D=l(19262),P=l(34603);const $=(0,I.j)({...(0,D.u)(),...(0,P.N6)()},"VLayout"),A=(0,F.RW)()({name:"VLayout",props:$(),setup(e,t){let{slots:l}=t;const{layoutClasses:o,layoutStyles:i,getLayoutItem:n,items:s,layoutRef:r}=(0,P.Vz)(e);return(0,C.C)((()=>(0,a.bF)("div",{ref:r,class:[o.value,e.class],style:[i.value,e.style]},[l.default?.()]))),{getLayoutItem:n,items:s}}});var B=l(51146);function _(e,t,l,d,c,p){const m=(0,a.g2)("ListButtons"),f=(0,a.g2)("ImportExport"),h=(0,a.g2)("BulkEdit"),v=(0,a.g2)("draggable");return(0,a.uX)(),(0,a.Wv)(A,null,{default:(0,a.k6)((()=>[(0,a.bF)(w,{modelValue:e.selected,"onUpdate:modelValue":t[1]||(t[1]=t=>e.selected=t),headers:p.activeHeaders,items:e.data.data,"item-value":"id","show-select":"","onClick:row":p.rowClick,loading:e.loading,"onUpdate:options":p.loadItems,"items-length":e.totalItems,"items-per-page":e.itemsPerPage,"onUpdate:itemsPerPage":t[2]||(t[2]=t=>e.itemsPerPage=t),search:e.search,"fixed-header":"","fixed-footer":"",class:"data-table-server",page:e.page},{top:(0,a.k6)((()=>[(0,a.bF)(B.i,{color:"secondary",class:"w-100"},{default:(0,a.k6)((()=>[l.hidebuttons?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(m,{key:0,selected:e.selected,section:e.internalSection,onChangeFields:t[0]||(t[0]=t=>e.dialog=!0),onAction:p.actionHandler,vars:l.vars,sortable:p.isSortable,data:e.buttonData,mobile:l.mobile},null,8,["selected","section","onAction","vars","sortable","data","mobile"]))])),_:1})])),bottom:(0,a.k6)((()=>[])),_:1},8,["modelValue","headers","items","onClick:row","loading","onUpdate:options","items-length","items-per-page","search","page"]),(0,a.bF)(f,{ref:"importExport",headers:e.headers,section:e.internalSection,fields:l.searchparams,columns:e.selectedHeaders,onReload:p.reload},null,8,["headers","section","fields","columns","onReload"]),(0,a.bF)(h,{ref:"bulkEdit",section:e.internalSection,fields:e.data?.fields,onAction:p.actionHandler,vars:l.vars,count:e.selected.length,defaultData:e.defaultData},null,8,["section","fields","onAction","vars","count","defaultData"]),(0,a.bF)(W.p,{modelValue:e.dialog,"onUpdate:modelValue":t[4]||(t[4]=t=>e.dialog=t),"max-width":"600",scrollable:""},{default:(0,a.k6)((()=>[(0,a.bF)(n.J,{title:"Fields"},{default:(0,a.k6)((()=>[(0,a.bF)(u.Py,{modelValue:e.selectedHeaders,"onUpdate:modelValue":t[3]||(t[3]=t=>e.selectedHeaders=t),headers:[{title:"Field",key:"title"}],items:e.headers,"item-value":"key","items-per-page":"-1","show-select":""},{bottom:(0,a.k6)((()=>[])),_:1},8,["modelValue","items"])])),_:1})])),_:1},8,["modelValue"]),(0,a.bF)(W.p,{modelValue:e.sortableDialog,"onUpdate:modelValue":t[8]||(t[8]=t=>e.sortableDialog=t),"max-width":"600",scrollable:""},{default:(0,a.k6)((()=>[(0,a.bF)(n.J,{title:"Sort Order",loading:e.sortOrderLoading},{default:(0,a.k6)((()=>[(0,a.bF)(s.O,null,{default:(0,a.k6)((()=>[(0,a.bF)(v,{modelValue:e.sortOrder,"onUpdate:modelValue":t[5]||(t[5]=t=>e.sortOrder=t),group:"items",onStart:t[6]||(t[6]=t=>e.drag=!0),onEnd:t[7]||(t[7]=t=>e.drag=!1),"item-key":"id"},{item:(0,a.k6)((({element:e})=>[(0,a.bF)(B.i,{color:"primary",class:"ma-5 pa-5"},{default:(0,a.k6)((()=>[(0,a.eW)((0,o.v_)(e.title),1)])),_:2},1024)])),_:1},8,["modelValue"])])),_:1}),(0,a.bF)(r.S,null,{default:(0,a.k6)((()=>[(0,a.bF)(i.D,{variant:"flat",color:"primary",onClick:p.saveSortOrder},{default:(0,a.k6)((()=>[(0,a.eW)("Save")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["loading"])])),_:1},8,["modelValue"])])),_:1})}l(44114);var O=l(74300),U=l(27274),H=l(19122),R=l.n(H),X=l(5089),j=l(61527),L=l.n(j),N=l(80266),z=l(78351),K=l(20105);const Q={key:1},J=(0,a.Lk)("h4",null,"Match up the fields",-1);function M(e,t,l,o,u,d){return(0,a.uX)(),(0,a.Wv)(W.p,{modelValue:e.importDialog,"onUpdate:modelValue":t[1]||(t[1]=t=>e.importDialog=t),"max-width":"600",scrollable:""},{default:(0,a.k6)((()=>[(0,a.bF)(n.J,{title:"Import"},{default:(0,a.k6)((()=>[(0,a.bF)(s.O,null,{default:(0,a.k6)((()=>[e.error?((0,a.uX)(),(0,a.Wv)(N.l,{key:0,text:e.error,type:"error"},null,8,["text"])):(0,a.Q3)("",!0),(0,a.bF)(z.f,{modelValue:e.file,"onUpdate:modelValue":[t[0]||(t[0]=t=>e.file=t),d.readFile],label:"CSV file"},null,8,["modelValue","onUpdate:modelValue"]),e.importHeaders.length?((0,a.uX)(),(0,a.CE)("div",Q,[J,((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(l.headers,((t,l)=>((0,a.uX)(),(0,a.CE)("div",{key:l},[(0,a.bF)(K.d4,{items:e.importHeaders,label:t.title,modelValue:e.importCols[t.key],"onUpdate:modelValue":l=>e.importCols[t.key]=l},null,8,["items","label","modelValue","onUpdate:modelValue"])])))),128))])):(0,a.Q3)("",!0)])),_:1}),(0,a.bF)(r.S,null,{default:(0,a.k6)((()=>[(0,a.bF)(i.D,{onClick:d.doImport,variant:"flat",color:"primary",disabled:!e.importHeaders.length},{default:(0,a.k6)((()=>[(0,a.eW)("Import")])),_:1},8,["onClick","disabled"])])),_:1})])),_:1})])),_:1},8,["modelValue"])}var T={props:{headers:null,section:null,fields:null,columns:null},data:function(){return{error:"",importDialog:!1,importHeaders:[],importCols:{}}},methods:{openImport:function(){this.importDialog=!0},doImport:async function(){const e=new FormData;for(const[l,a]of Object.entries(this.importCols))e.append("fields["+l+"]",a);e.append("file",this.file[0]),this.error="",this.loading=!0;const t=await O.A.post("?cmd=import&section="+this.internalSection,e,{headers:{"Content-Type":"multipart/form-data"}});this.loading=!1,t.data.error?this.error=t.data?.error:(this.importDialog=!1,this.$emit("reload"))},readFile:function(){const e=new FileReader;e.onload=e=>{const t=e.target.result,l=t.split("\n");let a=[],o=l[0].split(",");for(let n=0;n<o.length;n++){const e=o[n].trim();e.startsWith('"')&&e.endsWith('"')?a.push(e.slice(1,-1)):a.push(e)}let i=[];o=l[1].split(",");for(let n=0;n<o.length;n++){const e=o[n].trim();e.startsWith('"')&&e.endsWith('"')?i.push(e.slice(1,-1)):i.push(e)}this.importHeaders=[],a.forEach(((e,t)=>{this.importHeaders.push({value:t,raw:e,title:e+" - "+i[t]})})),this.importCols={},this.headers.forEach((e=>{let t=this.importHeaders.find((t=>t.raw===e.key));this.importCols[e.key]=t?t.value:""}))},e.readAsText(this.file[0])},exportItems:function(){let e={cmd:"export",section:this.section,fields:this.fields,columns:this.columns};const t=R().stringify(e);window.open(O.A.getApiRoot()+"?"+t)}}},G=l(71241);const Z=(0,G.A)(T,[["render",M]]);var q=Z,Y=l(92239),ee=l(40276),te=l(57254),le=l(43948);function ae(e,t,l,o,u,d){return(0,a.uX)(),(0,a.Wv)(W.p,{modelValue:e.dialog,"onUpdate:modelValue":t[0]||(t[0]=t=>e.dialog=t),"max-width":"600",scrollable:""},{default:(0,a.k6)((()=>[(0,a.bF)(n.J,{title:"Editing "+l.count+" files"},{default:(0,a.k6)((()=>[(0,a.bF)(s.O,null,{default:(0,a.k6)((()=>[e.error?((0,a.uX)(),(0,a.Wv)(N.l,{key:0,text:e.error,type:"error"},null,8,["text"])):(0,a.Q3)("",!0),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(l.fields,(t=>((0,a.uX)(),(0,a.CE)(a.FK,{key:t.type},[["id"].includes(t.type)?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(te.g,{key:0},{prepend:(0,a.k6)((()=>[(0,a.bF)(ee.a,{modelValue:e.enabled[t.column],"onUpdate:modelValue":l=>e.enabled[t.column]=l},null,8,["modelValue","onUpdate:modelValue"])])),default:(0,a.k6)((()=>[["checkbox"].includes(t.type)?((0,a.uX)(),(0,a.Wv)(ee.a,{key:0,label:d.formatString(t.column),modelValue:e.params[t.column],"onUpdate:modelValue":l=>e.params[t.column]=l,disabled:!e.enabled[t.column]},null,8,["label","modelValue","onUpdate:modelValue","disabled"])):["select"].includes(t.type)?((0,a.uX)(),(0,a.Wv)(K.d4,{key:1,label:d.formatString(t.column),items:e.options[t.column],modelValue:e.params[t.column],"onUpdate:modelValue":l=>e.params[t.column]=l,disabled:!e.enabled[t.column]},null,8,["label","items","modelValue","onUpdate:modelValue","disabled"])):["select_multiple"].includes(t.type)?((0,a.uX)(),(0,a.Wv)(K.d4,{key:2,label:d.formatString(t.column),items:e.options[t.column],modelValue:e.params[t.column],"onUpdate:modelValue":l=>e.params[t.column]=l,multiple:"",chips:"",disabled:!e.enabled[t.column]},null,8,["label","items","modelValue","onUpdate:modelValue","disabled"])):"combo"===t.type?((0,a.uX)(),(0,a.Wv)(Y.V,{key:3,label:d.formatString(t.column),modelValue:e.params[t.column],"onUpdate:modelValue":l=>e.params[t.column]=l,items:e.options[t.column],"onUpdate:search":e=>d.updateCombo(e,t.column),disabled:!e.enabled[t.column]},null,8,["label","modelValue","onUpdate:modelValue","items","onUpdate:search","disabled"])):((0,a.uX)(),(0,a.Wv)(le.W,{key:4,label:d.formatString(t.column),modelValue:e.params[t.column],"onUpdate:modelValue":l=>e.params[t.column]=l,disabled:!e.enabled[t.column]},null,8,["label","modelValue","onUpdate:modelValue","disabled"]))])),_:2},1024))],64)))),128))])),_:1}),(0,a.bF)(r.S,null,{default:(0,a.k6)((()=>[(0,a.bF)(i.D,{onClick:d.save,variant:"flat",color:"primary",disabled:!d.hasChanges},{default:(0,a.k6)((()=>[(0,a.eW)("Save")])),_:1},8,["onClick","disabled"])])),_:1})])),_:1},8,["title"])])),_:1},8,["modelValue"])}var oe={props:{section:null,fields:null,vars:null,count:null,defaultData:null},data:function(){return{dialog:!1,error:"",params:{},enabled:{},options:{}}},methods:{open:async function(){this.options=await U.A.getAllOptions(this.fields,this.vars.options,{}),console.log(this.defaultData),this.params=this.defaultData,this.dialog=!0},formatString:function(e){return U.A.formatString(e)},save:function(){this.$emit("action","bulkedit",{data:this.params})},updateCombo:async function(e,t){const l=await O.A.get("?cmd=autocomplete&field="+t+"&term="+e);this.options[t]=l.data}},computed:{hasChanges:function(){return Object.values(this.enabled).filter((e=>!0===e)).length>0}}};const ie=(0,G.A)(oe,[["render",ae]]);var ne=ie,se={components:{ListButtons:X.A,draggable:L(),ImportExport:q,BulkEdit:ne},props:{vars:null,section:null,hidebuttons:Boolean,parentsection:null,parentid:null,searchparams:null,mobile:null},data:function(){return{dialog:!1,selectedHeaders:[],headers:[],selected:[],data:{},internalSection:"",loading:!1,sortableDialog:!1,totalItems:0,itemsPerPage:20,page:1,search:"",drag:!1,sortOrder:[],sortOrderLoading:!1,file:[],filter:"",buttonData:{},defaultData:{}}},methods:{formatString:function(e){return U.A.formatString(e)},loadItems:async function({page:e,itemsPerPage:t,sortBy:l}){let a=this.searchparams;this.filter&&(a["s"]=this.filter);let o={cmd:"get",section:this.internalSection,fields:a,page:e,itemsPerPage:t,sortBy:l,columns:this.selectedHeaders};this.parentsection&&(o.parentsection=this.parentsection),this.parentid&&(o.parentid=this.parentid);const i=R().stringify(o);this.loading=!0;let n={};try{n=await O.A.get("?"+i.toString(),o)}catch(d){console.log(d)}if(this.loading=!1,!n.data?.fields)return!1;n.data.data||(n.data.data=[],n.data.total=0),n.data.data.forEach((e=>{for(const[,t]of Object.entries(n.data.fields))e[t.column+"_label"]?e[t.column]=e[t.column+"_label"]:e[t.column]=U.A.formatData(e[t.column],t.type)})),this.data=n.data,this.totalItems=this.data.total,this.$emit("updateCount",this.totalItems),this.buttonData={page:e,itemsPerPage:t,totalItems:this.totalItems},this.headers=[];let s=Object.values(n.data.fields);if(s.length&&!s.find((e=>"id"===e.column))){let e=U.A.base();return this.$router.push(e+"section/"+this.internalSection+"/1/"),!1}for(const[,c]of Object.entries(this.data.fields))this.headers.push({title:this.formatString(c.column),key:c.column});let r=s.map((e=>e.column));this.selectedHeaders.length||(this.selectedHeaders=r),this.$emit("changeHeaders",s),this.sortOrder=[],this.isSortable&&(this.data.data.forEach((e=>{let t=Object.keys(e)[0];this.sortOrder.push({title:t+": "+e[t],id:e.id,position:e.position})})),this.sortOrder.sort(((e,t)=>e.position-t.position)));let u=this.vars?.branding?.title?this.vars.branding.title:"ADMIN";document.title=u+" | "+this.internalSection,this.$emit("loaded")},rowClick:function(e,t){let l="/";this.$route.params.base&&(l+=this.$route.params.base+"/");let a=l+"section/"+this.internalSection+"/"+t.item.id+"/";this.parentsection&&(a+="?parentsection="+this.parentsection+"&parentid="+this.parentid),this.$router.push(a)},actionHandler:async function(e){let t={};if("export"===e)return["Basic","Business"].includes(U.A.getEdition())?void this.$refs["importExport"].exportItems():void this.$router.push(U.A.base()+"upgrade");if("import"===e)return["Basic","Business"].includes(U.A.getEdition())?void this.$refs["importExport"].openImport():void this.$router.push(U.A.base()+"upgrade");if("openBulkEdit"===e){this.defaultData={};let e=0;return this.selected.forEach((t=>{let l=this.data.data.find((e=>t==e.id));for(const[a,o]of Object.entries(l))0===e?this.defaultData[a]=o:this.defaultData[a]!==o&&(this.defaultData[a]=null);e++})),void this.$refs["bulkEdit"].open()}if("openSortable"===e)return void(this.sortableDialog=!0);if("filter"===e)return this.filter=arguments[1],void this.reload();if("prevPage"===e){if(1===this.page)return;return void this.page--}if("nextPage"===e){if(this.page*this.itemsPerPage>=this.totalItems)return;return void this.page++}if("string"===typeof e)return t={cmd:e,section:this.internalSection,ids:this.selected},"object"===typeof arguments[1]&&(t={...t,...arguments[1]}),this.loading=!0,await O.A.post("?cmd="+e+"&section="+this.internalSection,t),void this.reload();if(!["Basic","Business"].includes(U.A.getEdition()))return void this.$router.push(U.A.base()+"upgrade");t={cmd:"button",button:e.id,section:this.internalSection,ids:this.selected},this.loading=!0;const l=await O.A.post("?cmd=button&section="+this.internalSection,t);this.loading=!1,l.data.error&&alert(l.data.error),l.data.result?.redirect?e.target?window.open(l.data.result.redirect):location.href=l.data.result.redirect:this.reload()},saveSortOrder:async function(){let e={cmd:"reorder",section:this.section,items:this.sortOrder};this.sortOrderLoading=!0,await O.A.post("?cmd=reorder&section="+this.internalSection,e),this.sortOrderLoading=!1,this.sortableDialog=!1,this.reload()},reload:function(){this.search=String(Date.now())}},watch:{internalSection:function(){localStorage["fields_"+this.internalSection]&&(this.selectedHeaders=JSON.parse(localStorage["fields_"+this.internalSection]))},$route(e){this.internalSection=e.params.section,this.reload()},section:function(e){this.internalSection=e,this.reload()},selectedHeaders:function(e,t){if(JSON.stringify(e)!==JSON.stringify(t)&&(localStorage["fields_"+this.internalSection]=JSON.stringify(Object.values(e))),this.data.fields){let t=[];for(const[,l]of Object.entries(this.data.fields))e.includes(l.column)&&t.push(l);this.$emit("changeFields",t)}},searchparams:function(){this.reload()},headers:function(e){let t=localStorage["fields_"+this.internalSection],l=t?JSON.parse(t):e.map((e=>e.key)),a=e.map((e=>e.key));l=l.filter((e=>a.includes(e))),this.selectedHeaders=l}},computed:{activeHeaders:function(){let e=[];return this.data.fields&&Object.values(this.data.fields).forEach((t=>{this.selectedHeaders.includes(t.column)&&e.push({title:this.formatString(t.column),value:t.column,sortable:!0})})),e},isSortable:function(){let e=!1;return this.data.fields&&Object.values(this.data.fields).forEach((t=>{"position"===t.type&&(e=!0)})),e}},created(){this.internalSection=this.section?this.section:this.$route.params.section}};const re=(0,G.A)(se,[["render",_]]);var ue=re},78351:function(e,t,l){l.d(t,{f:function(){return b}});var a=l(56768),o=l(95523),i=l(31622),n=l(54577),s=l(65035),r=l(76935),u=l(61950),d=l(95296),c=l(82067),p=l(90144),m=l(14587),f=l(29094),h=l(51247),v=l(74600);const g=(0,m.j)({chips:Boolean,counter:Boolean,counterSizeString:{type:String,default:"$vuetify.fileInput.counterSize"},counterString:{type:String,default:"$vuetify.fileInput.counter"},multiple:Boolean,showSize:{type:[Boolean,Number,String],default:!1,validator:e=>"boolean"===typeof e||[1e3,1024].includes(Number(e))},...(0,s.V)({prependIcon:"$file"}),modelValue:{type:Array,default:()=>[],validator:e=>(0,f.BN)(e).every((e=>null!=e&&"object"===typeof e))},...(0,n.tG)({clearable:!0})},"VFileInput"),b=(0,h.RW)()({name:"VFileInput",inheritAttrs:!1,props:g(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,t){let{attrs:l,emit:m,slots:h}=t;const{t:g}=(0,d.Ym)(),b=(0,c.q)(e,"modelValue"),{isFocused:y,focus:S,blur:k}=(0,r.i)(e),x=(0,a.EW)((()=>"boolean"!==typeof e.showSize?e.showSize:void 0)),V=(0,a.EW)((()=>(b.value??[]).reduce(((e,t)=>{let{size:l=0}=t;return e+l}),0))),I=(0,a.EW)((()=>(0,f.hA)(V.value,x.value))),F=(0,a.EW)((()=>(b.value??[]).map((t=>{const{name:l="",size:a=0}=t;return e.showSize?`${l} (${(0,f.hA)(a,x.value)})`:l})))),C=(0,a.EW)((()=>{const t=b.value?.length??0;return e.showSize?g(e.counterSizeString,t,I.value):g(e.counterString,t)})),E=(0,p.KR)(),w=(0,p.KR)(),W=(0,p.KR)(),D=(0,a.EW)((()=>y.value||e.active)),P=(0,a.EW)((()=>["plain","underlined"].includes(e.variant)));function $(){W.value!==document.activeElement&&W.value?.focus(),y.value||S()}function A(e){W.value?.click()}function B(e){m("mousedown:control",e)}function _(e){W.value?.click(),m("click:control",e)}function O(t){t.stopPropagation(),$(),(0,a.dY)((()=>{b.value=[],(0,f.P)(e["onClick:clear"],t)}))}return(0,a.wB)(b,(e=>{const t=!Array.isArray(e)||!e.length;t&&W.value&&(W.value.value="")})),(0,v.C)((()=>{const t=!(!h.counter&&!e.counter),r=!(!t&&!h.details),[u,d]=(0,f.ph)(l),{modelValue:c,...p}=s.Z.filterProps(e),m=(0,n.jz)(e);return(0,a.bF)(s.Z,(0,a.v6)({ref:E,modelValue:b.value,"onUpdate:modelValue":e=>b.value=e,class:["v-file-input",{"v-file-input--chips":!!e.chips,"v-input--plain-underlined":P.value},e.class],style:e.style,"onClick:prepend":A},u,p,{centerAffix:!P.value,focused:y.value}),{...h,default:t=>{let{id:l,isDisabled:i,isDirty:s,isReadonly:r,isValid:u}=t;return(0,a.bF)(n.xR,(0,a.v6)({ref:w,"prepend-icon":e.prependIcon,onMousedown:B,onClick:_,"onClick:clear":O,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},m,{id:l.value,active:D.value||s.value,dirty:s.value,disabled:i.value,focused:y.value,error:!1===u.value}),{...h,default:t=>{let{props:{class:l,...n}}=t;return(0,a.bF)(a.FK,null,[(0,a.bF)("input",(0,a.v6)({ref:W,type:"file",readonly:r.value,disabled:i.value,multiple:e.multiple,name:e.name,onClick:e=>{e.stopPropagation(),r.value&&e.preventDefault(),$()},onChange:e=>{if(!e.target)return;const t=e.target;b.value=[...t.files??[]]},onFocus:$,onBlur:k},n,d),null),(0,a.bF)("div",{class:l},[!!b.value?.length&&(h.selection?h.selection({fileNames:F.value,totalBytes:V.value,totalBytesReadable:I.value}):e.chips?F.value.map((t=>(0,a.bF)(o.x,{key:t,size:"small",color:e.color},{default:()=>[t]}))):F.value.join(", "))])])}})},details:r?e=>(0,a.bF)(a.FK,null,[h.details?.(e),t&&(0,a.bF)(a.FK,null,[(0,a.bF)("span",null,null),(0,a.bF)(i.p,{active:!!b.value?.length,value:C.value},h.counter)])]):void 0})})),(0,u.O)({},E,w,W)}})},35526:function(e,t,l){l.d(t,{B:function(){return g}});l(44114),l(65792);var a=l(19262),o=l(68353),i=l(54663),n=l(24232),s=l(56768),r=l(14587),u=l(51247);const d=(()=>o.fi.reduce(((e,t)=>(e[t]={type:[Boolean,String,Number],default:!1},e)),{}))(),c=(()=>o.fi.reduce(((e,t)=>{const l="offset"+(0,n.ZH)(t);return e[l]={type:[String,Number],default:null},e}),{}))(),p=(()=>o.fi.reduce(((e,t)=>{const l="order"+(0,n.ZH)(t);return e[l]={type:[String,Number],default:null},e}),{}))(),m={col:Object.keys(d),offset:Object.keys(c),order:Object.keys(p)};function f(e,t,l){let a=e;if(null!=l&&!1!==l){if(t){const l=t.replace(e,"");a+=`-${l}`}return"col"===e&&(a="v-"+a),"col"!==e||""!==l&&!0!==l?(a+=`-${l}`,a.toLowerCase()):a.toLowerCase()}}const h=["auto","start","end","center","baseline","stretch"],v=(0,r.j)({cols:{type:[Boolean,String,Number],default:!1},...d,offset:{type:[String,Number],default:null},...c,order:{type:[String,Number],default:null},...p,alignSelf:{type:String,default:null,validator:e=>h.includes(e)},...(0,a.u)(),...(0,i.X)()},"VCol"),g=(0,u.RW)()({name:"VCol",props:v(),setup(e,t){let{slots:l}=t;const a=(0,s.EW)((()=>{const t=[];let l;for(l in m)m[l].forEach((a=>{const o=e[a],i=f(l,a,o);i&&t.push(i)}));const a=t.some((e=>e.startsWith("v-col-")));return t.push({"v-col":!a||!e.cols,[`v-col-${e.cols}`]:e.cols,[`offset-${e.offset}`]:e.offset,[`order-${e.order}`]:e.order,[`align-self-${e.alignSelf}`]:e.alignSelf}),t}));return()=>(0,s.h)(e.tag,{class:[a.value,e.class],style:e.style},l.default?.())}})},34603:function(e,t,l){l.d(t,{CK:function(){return m},N6:function(){return p},Vz:function(){return g},gK:function(){return f},hc:function(){return h}});l(44114);var a=l(65399),o=l(56768),i=l(90144),n=l(14587),s=l(37861),r=l(29094);const u=Symbol.for("vuetify:layout"),d=Symbol.for("vuetify:layout-item"),c=1e3,p=(0,n.j)({overlaps:{type:Array,default:()=>[]},fullHeight:Boolean},"layout"),m=(0,n.j)({name:{type:String},order:{type:[Number,String],default:0},absolute:Boolean},"layout-item");function f(){const e=(0,o.WQ)(u);if(!e)throw new Error("[Vuetify] Could not find injected layout");return{getLayoutItem:e.getLayoutItem,mainRect:e.mainRect,mainStyles:e.mainStyles}}function h(e){const t=(0,o.WQ)(u);if(!t)throw new Error("[Vuetify] Could not find injected layout");const l=e.id??`layout-item-${(0,s.v6)()}`,a=(0,s.nI)("useLayoutItem");(0,o.Gt)(d,{id:l});const n=(0,i.IJ)(!1);(0,o.Y4)((()=>n.value=!0)),(0,o.n)((()=>n.value=!1));const{layoutItemStyles:r,layoutItemScrimStyles:c}=t.register(a,{...e,active:(0,o.EW)((()=>!n.value&&e.active.value)),id:l});return(0,o.xo)((()=>t.unregister(l))),{layoutItemStyles:r,layoutRect:t.layoutRect,layoutItemScrimStyles:c}}const v=(e,t,l,a)=>{let o={top:0,left:0,right:0,bottom:0};const i=[{id:"",layer:{...o}}];for(const n of e){const e=t.get(n),s=l.get(n),r=a.get(n);if(!e||!s||!r)continue;const u={...o,[e.value]:parseInt(o[e.value],10)+(r.value?parseInt(s.value,10):0)};i.push({id:n,layer:u}),o=u}return i};function g(e){const t=(0,o.WQ)(u,null),l=(0,o.EW)((()=>t?t.rootZIndex.value-100:c)),n=(0,i.KR)([]),p=(0,i.Kh)(new Map),m=(0,i.Kh)(new Map),f=(0,i.Kh)(new Map),h=(0,i.Kh)(new Map),g=(0,i.Kh)(new Map),{resizeRef:b,contentRect:y}=(0,a.w)(),S=(0,o.EW)((()=>{const t=new Map,l=e.overlaps??[];for(const e of l.filter((e=>e.includes(":")))){const[l,a]=e.split(":");if(!n.value.includes(l)||!n.value.includes(a))continue;const o=p.get(l),i=p.get(a),s=m.get(l),r=m.get(a);o&&i&&s&&r&&(t.set(a,{position:o.value,amount:parseInt(s.value,10)}),t.set(l,{position:i.value,amount:-parseInt(r.value,10)}))}return t})),k=(0,o.EW)((()=>{const e=[...new Set([...f.values()].map((e=>e.value)))].sort(((e,t)=>e-t)),t=[];for(const l of e){const e=n.value.filter((e=>f.get(e)?.value===l));t.push(...e)}return v(t,p,m,h)})),x=(0,o.EW)((()=>!Array.from(g.values()).some((e=>e.value)))),V=(0,o.EW)((()=>k.value[k.value.length-1].layer)),I=(0,o.EW)((()=>({"--v-layout-left":(0,r.Dg)(V.value.left),"--v-layout-right":(0,r.Dg)(V.value.right),"--v-layout-top":(0,r.Dg)(V.value.top),"--v-layout-bottom":(0,r.Dg)(V.value.bottom),...x.value?void 0:{transition:"none"}}))),F=(0,o.EW)((()=>k.value.slice(1).map(((e,t)=>{let{id:l}=e;const{layer:a}=k.value[t],o=m.get(l),i=p.get(l);return{id:l,...a,size:Number(o.value),position:i.value}})))),C=e=>F.value.find((t=>t.id===e)),E=(0,s.nI)("createLayout"),w=(0,i.IJ)(!1);(0,o.sV)((()=>{w.value=!0})),(0,o.Gt)(u,{register:(e,t)=>{let{id:a,order:i,position:s,layoutSize:u,elementSize:v,active:b,disableTransitions:y,absolute:V}=t;f.set(a,i),p.set(a,s),m.set(a,u),h.set(a,b),y&&g.set(a,y);const I=(0,r["if"])(d,E?.vnode),C=I.indexOf(e);C>-1?n.value.splice(C,0,a):n.value.push(a);const W=(0,o.EW)((()=>F.value.findIndex((e=>e.id===a)))),D=(0,o.EW)((()=>l.value+2*k.value.length-2*W.value)),P=(0,o.EW)((()=>{const e="left"===s.value||"right"===s.value,t="right"===s.value,o="bottom"===s.value,i={[s.value]:0,zIndex:D.value,transform:`translate${e?"X":"Y"}(${(b.value?0:-110)*(t||o?-1:1)}%)`,position:V.value||l.value!==c?"absolute":"fixed",...x.value?void 0:{transition:"none"}};if(!w.value)return i;const n=F.value[W.value];if(!n)throw new Error(`[Vuetify] Could not find layout item "${a}"`);const r=S.value.get(a);return r&&(n[r.position]+=r.amount),{...i,height:e?`calc(100% - ${n.top}px - ${n.bottom}px)`:v.value?`${v.value}px`:void 0,left:t?void 0:`${n.left}px`,right:t?`${n.right}px`:void 0,top:"bottom"!==s.value?`${n.top}px`:void 0,bottom:"top"!==s.value?`${n.bottom}px`:void 0,width:e?v.value?`${v.value}px`:void 0:`calc(100% - ${n.left}px - ${n.right}px)`}})),$=(0,o.EW)((()=>({zIndex:D.value-1})));return{layoutItemStyles:P,layoutItemScrimStyles:$,zIndex:D}},unregister:e=>{f.delete(e),p.delete(e),m.delete(e),h.delete(e),g.delete(e),n.value=n.value.filter((t=>t!==e))},mainRect:V,mainStyles:I,getLayoutItem:C,items:F,layoutRect:y,rootZIndex:l});const W=(0,o.EW)((()=>["v-layout",{"v-layout--full-height":e.fullHeight}])),D=(0,o.EW)((()=>({zIndex:t?l.value:void 0,position:t?"relative":void 0,overflow:t?"hidden":void 0})));return{layoutClasses:W,layoutStyles:D,getLayoutItem:C,items:F,layoutRect:y,layoutRef:b}}}}]);
//# sourceMappingURL=9.3f835b90.js.map