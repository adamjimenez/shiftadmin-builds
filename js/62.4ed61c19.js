"use strict";(self["webpackChunkshiftadmin"]=self["webpackChunkshiftadmin"]||[]).push([[62],{781:function(e,t,l){l.d(t,{Z:function(){return v}});var a=l(3396),o=l(7139),i=l(7312),n=l(9234),s=l(8521),r=l(6052),u=l(3150),d=l(2127),c=l(4193);const m={class:"d-flex w-100 align-center"};function p(e,t,l,p,f,h){return(0,a.wg)(),(0,a.iD)("span",m,[(0,a.Wm)(i.T,{variant:"text",title:"Add",icon:"mdi-plus",to:h.base+"section/"+e.internalSection+"/add"+(l.parentsection?"?parentsection="+l.parentsection+"&parentid="+l.parentid:"")},null,8,["to"]),(0,a.Wm)(i.T,{variant:"text",title:"Fields",icon:"mdi-view-column",color:"grey-lighten-1",onClick:h.changeFields},null,8,["onClick"]),l.selected.length?((0,a.wg)(),(0,a.j4)(i.T,{key:0,variant:"text",title:"Bulk Edit",icon:"mdi-pencil",color:"grey-lighten-1",onClick:t[0]||(t[0]=e=>h.doAction("openBulkEdit"))})):(0,a.kq)("",!0),l.selected.length?((0,a.wg)(),(0,a.j4)(i.T,{key:1,variant:"text",title:"Delete",icon:"mdi-delete",color:"grey-lighten-1",onClick:t[1]||(t[1]=e=>h.doAction("delete"))})):(0,a.kq)("",!0),(0,a.Wm)(i.T,{variant:"text",title:"Import",icon:"mdi-import",color:"grey-lighten-1",onClick:h.openImport},null,8,["onClick"]),(0,a.Wm)(i.T,{variant:"text",title:"Export",icon:"mdi-export",color:"grey-lighten-1",onClick:h.exportItems},null,8,["onClick"]),l.sortable?((0,a.wg)(),(0,a.j4)(i.T,{key:2,variant:"text",title:"Sort",icon:"mdi-sort",color:"grey-lighten-1",onClick:t[2]||(t[2]=e=>h.doAction("openSortable"))})):(0,a.kq)("",!0),h.buttons.length?((0,a.wg)(),(0,a.j4)(c.T,{key:3},{activator:(0,a.w5)((({props:e})=>[(0,a.Wm)(i.T,(0,a.dG)({variant:"text"},e,{icon:"mdi-dots-vertical"}),null,16)])),default:(0,a.w5)((()=>[(0,a.Wm)(r.i,null,{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(h.buttons,((e,t)=>((0,a.wg)(),(0,a.j4)(u.l,{key:t,value:t,onClick:t=>h.customButton(e)},{default:(0,a.w5)((()=>[(0,a.Wm)(d.V,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.label),1)])),_:2},1024)])),_:2},1032,["value","onClick"])))),128))])),_:1})])),_:1})):(0,a.kq)("",!0),(0,a.Wm)(n.C),(0,a.Wm)(s.D,{class:"text-grey-lighten-1 text-right"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(parseInt((l.data.page-1)*l.data.itemsPerPage+1)?.toLocaleString())+"-"+(0,o.zw)(Math.min(l.data.page*l.data.itemsPerPage,l.data.totalItems)?.toLocaleString())+" of "+(0,o.zw)(l.data.totalItems?.toLocaleString()),1)])),_:1}),(0,a.Wm)(i.T,{variant:"text",icon:"mdi-chevron-left",disabled:1===l.data.page,onClick:h.prevPage},null,8,["disabled","onClick"]),(0,a.Wm)(i.T,{variant:"text",icon:"mdi-chevron-right",disabled:l.data.page*l.data.itemsPerPage>=l.data.totalItems,onClick:h.nextPage},null,8,["disabled","onClick"])])}l(560);var f={props:{vars:null,section:null,hidebuttons:Boolean,parentsection:null,parentid:null,searchparams:null,selected:null,data:null,headers:null,sortable:Boolean},data:function(){return{dialog:!1,selectedHeaders:[],internalSection:"",loading:!1,filter:""}},methods:{formatString:function(e){return e=e.replace(/_/g," "),e.charAt(0).toUpperCase()+e.slice(1)},doAction:async function(e){this.$emit("action",e)},exportItems:function(){this.$emit("action","export")},changeFields:function(){this.$emit("changeFields")},customButton:function(e){this.$emit("action",e)},openImport:function(){this.$emit("action","import")},prevPage:function(){this.$emit("action","prevPage")},nextPage:function(){this.$emit("action","nextPage")}},watch:{section:function(e){this.internalSection=e},filter:function(e){this.$emit("action","filter",e)}},computed:{buttons:function(){let e=[];return this.vars?.buttons?.forEach(((t,l)=>{"list"===t.page&&t.section===this.internalSection&&(t.id=l,e.push(t))})),e},base(){let e="/";return this.$route.params.base&&(e+=this.$route.params.base+"/"),e}},created(){this.internalSection=this.section?this.section:this.$route.params.section}},h=l(89);const g=(0,h.Z)(f,[["render",p]]);var v=g},9062:function(e,t,l){l.r(t),l.d(t,{default:function(){return ue}});var a=l(3396),o=l(7139),i=l(7312),n=l(1489),s=l(1888),r=l(1334),u=l(6658),d=l(2934),c=l(2804),m=l(461),p=l(1231),f=l(7471),h=l(6969),g=l(8829),v=l(3890),y=l(7609),b=l(9207),S=l(2651),w=l(2864),k=l(6107),V=l(4870),x=l(3766),I=l(1107),C=l(9888);const W=(0,x.U)({itemsLength:{type:[Number,String],required:!0},...(0,b.Gj)(),...(0,u.Sz)(),...(0,d.p)()},"VDataTableServer"),P=(0,I.ev)()({name:"VDataTableServer",props:W(),emits:{"update:modelValue":e=>!0,"update:page":e=>!0,"update:itemsPerPage":e=>!0,"update:sortBy":e=>!0,"update:options":e=>!0,"update:expanded":e=>!0,"update:groupBy":e=>!0},setup(e,t){let{attrs:l,slots:o}=t;const{groupBy:i}=(0,h.my)(e),{sortBy:n,multiSort:s,mustSort:r}=(0,w.lx)(e),{page:u,itemsPerPage:x}=(0,b.FV)(e),I=(0,a.Fl)((()=>parseInt(e.itemsLength,10))),{columns:W,headers:P}=(0,g.IT)(e,{groupBy:i,showSelect:(0,V.Vh)(e,"showSelect"),showExpand:(0,V.Vh)(e,"showExpand")}),{items:$}=(0,v.hh)(e,W),{toggleSort:B}=(0,w.NV)({sortBy:n,multiSort:s,mustSort:r,page:u}),{opened:D,isGroupOpen:_,toggleGroup:F,extractRows:U}=(0,h.P_)({groupBy:i,sortBy:n}),{pageCount:j,setItemsPerPage:H}=(0,b.ku)({page:u,itemsPerPage:x,itemsLength:I}),{flatItems:E}=(0,h.T5)($,i,D),{isSelected:O,select:Z,selectAll:L,toggleSelect:A,someSelected:T,allSelected:z}=(0,S.mH)(e,{allItems:$,currentPage:$}),{isExpanded:N,toggleExpand:R}=(0,f.BM)(e),q=(0,a.Fl)((()=>U($.value)));(0,y.D)({page:u,itemsPerPage:x,sortBy:n,groupBy:i,search:(0,V.Vh)(e,"search")}),(0,a.JJ)("v-data-table",{toggleSort:B,sortBy:n}),(0,k.AF)({VDataTableRows:{hideNoData:(0,V.Vh)(e,"hideNoData"),noDataText:(0,V.Vh)(e,"noDataText"),loading:(0,V.Vh)(e,"loading"),loadingText:(0,V.Vh)(e,"loadingText")}});const Y=(0,a.Fl)((()=>({page:u.value,itemsPerPage:x.value,sortBy:n.value,pageCount:j.value,toggleSort:B,setItemsPerPage:H,someSelected:T.value,allSelected:z.value,isSelected:O,select:Z,selectAll:L,toggleSelect:A,isExpanded:N,toggleExpand:R,isGroupOpen:_,toggleGroup:F,items:q.value.map((e=>e.raw)),internalItems:q.value,groupedItems:E.value,columns:W.value,headers:P.value})));(0,C.L)((()=>{const t=d.i.filterProps(e),i=c.I.filterProps(e),n=m.f.filterProps(e),s=p.Y.filterProps(e);return(0,a.Wm)(p.Y,(0,a.dG)({class:["v-data-table",{"v-data-table--loading":e.loading},e.class],style:e.style},s),{top:()=>o.top?.(Y.value),default:()=>o.default?o.default(Y.value):(0,a.Wm)(a.HY,null,[o.colgroup?.(Y.value),(0,a.Wm)("thead",{class:"v-data-table__thead",role:"rowgroup"},[(0,a.Wm)(c.I,(0,a.dG)(i,{sticky:e.fixedHeader}),o)]),o.thead?.(Y.value),(0,a.Wm)("tbody",{class:"v-data-table__tbody",role:"rowgroup"},[o["body.prepend"]?.(Y.value),o.body?o.body(Y.value):(0,a.Wm)(m.f,(0,a.dG)(l,n,{items:E.value}),o),o["body.append"]?.(Y.value)]),o.tbody?.(Y.value),o.tfoot?.(Y.value)]),bottom:()=>o.bottom?o.bottom(Y.value):(0,a.Wm)(d.i,t,{prepend:o["footer.prepend"]})})}))}});var $=l(3601),B=l(9166),D=l(7396);const _=(0,x.U)({...(0,B.l)(),...(0,D.GB)()},"VLayout"),F=(0,I.ev)()({name:"VLayout",props:_(),setup(e,t){let{slots:l}=t;const{layoutClasses:o,layoutStyles:i,getLayoutItem:n,items:s,layoutRef:r}=(0,D.te)(e);return(0,C.L)((()=>(0,a.Wm)("div",{ref:r,class:[o.value,e.class],style:[i.value,e.style]},[l.default?.()]))),{getLayoutItem:n,items:s}}});var U=l(4286);function j(e,t,l,d,c,m){const p=(0,a.up)("ListButtons"),f=(0,a.up)("ImportExport"),h=(0,a.up)("BulkEdit"),g=(0,a.up)("draggable");return(0,a.wg)(),(0,a.j4)(F,null,{default:(0,a.w5)((()=>[(0,a.Wm)(P,{modelValue:e.selected,"onUpdate:modelValue":t[1]||(t[1]=t=>e.selected=t),headers:m.activeHeaders,items:e.data.data,"item-value":"id","show-select":"","onClick:row":m.rowClick,loading:e.loading,"onUpdate:options":m.loadItems,"items-length":e.totalItems,"items-per-page":e.itemsPerPage,"onUpdate:itemsPerPage":t[2]||(t[2]=t=>e.itemsPerPage=t),search:e.search,"fixed-header":"","fixed-footer":"",class:"data-table-server",page:e.page},{top:(0,a.w5)((()=>[(0,a.Wm)(U.C,{color:"secondary",class:"w-100"},{default:(0,a.w5)((()=>[l.hidebuttons?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(p,{key:0,selected:e.selected,section:e.internalSection,onChangeFields:t[0]||(t[0]=t=>e.dialog=!0),onAction:m.actionHandler,vars:l.vars,sortable:m.isSortable,data:e.buttonData},null,8,["selected","section","onAction","vars","sortable","data"]))])),_:1})])),bottom:(0,a.w5)((()=>[])),_:1},8,["modelValue","headers","items","onClick:row","loading","onUpdate:options","items-length","items-per-page","search","page"]),(0,a.Wm)(f,{ref:"importExport",headers:e.headers,section:e.internalSection,fields:l.searchparams,columns:e.selectedHeaders,onReload:m.reload},null,8,["headers","section","fields","columns","onReload"]),(0,a.Wm)(h,{ref:"bulkEdit",section:e.internalSection,fields:e.data?.fields,onAction:m.actionHandler,vars:l.vars,count:e.selected.length,defaultData:e.defaultData},null,8,["section","fields","onAction","vars","count","defaultData"]),(0,a.Wm)($.B,{modelValue:e.dialog,"onUpdate:modelValue":t[4]||(t[4]=t=>e.dialog=t),"max-width":"600",scrollable:""},{default:(0,a.w5)((()=>[(0,a.Wm)(n._,{title:"Fields"},{default:(0,a.w5)((()=>[(0,a.Wm)(u.y_,{modelValue:e.selectedHeaders,"onUpdate:modelValue":t[3]||(t[3]=t=>e.selectedHeaders=t),headers:[{title:"Field",key:"title"}],items:e.headers,"item-value":"key","items-per-page":"-1","show-select":""},{bottom:(0,a.w5)((()=>[])),_:1},8,["modelValue","items"])])),_:1})])),_:1},8,["modelValue"]),(0,a.Wm)($.B,{modelValue:e.sortableDialog,"onUpdate:modelValue":t[8]||(t[8]=t=>e.sortableDialog=t),"max-width":"600",scrollable:""},{default:(0,a.w5)((()=>[(0,a.Wm)(n._,{title:"Sort Order",loading:e.sortOrderLoading},{default:(0,a.w5)((()=>[(0,a.Wm)(s.Z,null,{default:(0,a.w5)((()=>[(0,a.Wm)(g,{modelValue:e.sortOrder,"onUpdate:modelValue":t[5]||(t[5]=t=>e.sortOrder=t),group:"items",onStart:t[6]||(t[6]=t=>e.drag=!0),onEnd:t[7]||(t[7]=t=>e.drag=!1),"item-key":"id"},{item:(0,a.w5)((({element:e})=>[(0,a.Wm)(U.C,{color:"primary",class:"ma-5 pa-5"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.title),1)])),_:2},1024)])),_:1},8,["modelValue"])])),_:1}),(0,a.Wm)(r.h,null,{default:(0,a.w5)((()=>[(0,a.Wm)(i.T,{variant:"flat",color:"primary",onClick:m.saveSortOrder},{default:(0,a.w5)((()=>[(0,a.Uk)("Save")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["loading"])])),_:1},8,["modelValue"])])),_:1})}l(560);var H=l(1006),E=l(2564),O=l(5410),Z=l.n(O),L=l(781),A=l(6983),T=l.n(A),z=l(7771),N=l(3121),R=l(240);const q={key:1},Y=(0,a._)("h4",null,"Match up the fields",-1);function G(e,t,l,o,u,d){return(0,a.wg)(),(0,a.j4)($.B,{modelValue:e.importDialog,"onUpdate:modelValue":t[1]||(t[1]=t=>e.importDialog=t),"max-width":"600",scrollable:""},{default:(0,a.w5)((()=>[(0,a.Wm)(n._,{title:"Import"},{default:(0,a.w5)((()=>[(0,a.Wm)(s.Z,null,{default:(0,a.w5)((()=>[e.error?((0,a.wg)(),(0,a.j4)(z.w,{key:0,text:e.error,type:"error"},null,8,["text"])):(0,a.kq)("",!0),(0,a.Wm)(N.Z,{modelValue:e.file,"onUpdate:modelValue":[t[0]||(t[0]=t=>e.file=t),d.readFile],label:"CSV file"},null,8,["modelValue","onUpdate:modelValue"]),e.importHeaders.length?((0,a.wg)(),(0,a.iD)("div",q,[Y,((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(l.headers,((t,l)=>((0,a.wg)(),(0,a.iD)("div",{key:l},[(0,a.Wm)(R.rL,{items:e.importHeaders,label:t.title,modelValue:e.importCols[t.key],"onUpdate:modelValue":l=>e.importCols[t.key]=l},null,8,["items","label","modelValue","onUpdate:modelValue"])])))),128))])):(0,a.kq)("",!0)])),_:1}),(0,a.Wm)(r.h,null,{default:(0,a.w5)((()=>[(0,a.Wm)(i.T,{onClick:d.doImport,variant:"flat",color:"primary",disabled:!e.importHeaders.length},{default:(0,a.w5)((()=>[(0,a.Uk)("Import")])),_:1},8,["onClick","disabled"])])),_:1})])),_:1})])),_:1},8,["modelValue"])}var J={props:{headers:null,section:null,fields:null,columns:null},data:function(){return{error:"",importDialog:!1,importHeaders:[],importCols:{}}},methods:{openImport:function(){this.importDialog=!0},doImport:async function(){const e=new FormData;for(const[l,a]of Object.entries(this.importCols))e.append("fields["+l+"]",a);e.append("file",this.file[0]),this.error="",this.loading=!0;const t=await H.Z.post("?cmd=import&section="+this.internalSection,e,{headers:{"Content-Type":"multipart/form-data"}});this.loading=!1,t.data.error?this.error=t.data?.error:(this.importDialog=!1,this.$emit("reload"))},readFile:function(){const e=new FileReader;e.onload=e=>{const t=e.target.result,l=t.split("\n");let a=[],o=l[0].split(",");for(let n=0;n<o.length;n++){const e=o[n].trim();e.startsWith('"')&&e.endsWith('"')?a.push(e.slice(1,-1)):a.push(e)}let i=[];o=l[1].split(",");for(let n=0;n<o.length;n++){const e=o[n].trim();e.startsWith('"')&&e.endsWith('"')?i.push(e.slice(1,-1)):i.push(e)}this.importHeaders=[],a.forEach(((e,t)=>{this.importHeaders.push({value:t,raw:e,title:e+" - "+i[t]})})),this.importCols={},this.headers.forEach((e=>{let t=this.importHeaders.find((t=>t.raw===e.key));this.importCols[e.key]=t?t.value:""}))},e.readAsText(this.file[0])},exportItems:function(){let e={cmd:"export",section:this.section,fields:this.fields,columns:this.columns};const t=Z().stringify(e);window.open(H.Z.getApiRoot()+"?"+t)}}},M=l(89);const X=(0,M.Z)(J,[["render",G]]);var K=X,Q=l(2650),ee=l(1222),te=l(3150),le=l(165);function ae(e,t,l,o,u,d){return(0,a.wg)(),(0,a.j4)($.B,{modelValue:e.dialog,"onUpdate:modelValue":t[0]||(t[0]=t=>e.dialog=t),"max-width":"600",scrollable:""},{default:(0,a.w5)((()=>[(0,a.Wm)(n._,{title:"Editing "+l.count+" files"},{default:(0,a.w5)((()=>[(0,a.Wm)(s.Z,null,{default:(0,a.w5)((()=>[e.error?((0,a.wg)(),(0,a.j4)(z.w,{key:0,text:e.error,type:"error"},null,8,["text"])):(0,a.kq)("",!0),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(l.fields,(t=>((0,a.wg)(),(0,a.iD)(a.HY,{key:t.type},[["id"].includes(t.type)?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(te.l,{key:0},{prepend:(0,a.w5)((()=>[(0,a.Wm)(ee.x,{modelValue:e.enabled[t.column],"onUpdate:modelValue":l=>e.enabled[t.column]=l},null,8,["modelValue","onUpdate:modelValue"])])),default:(0,a.w5)((()=>[["checkbox"].includes(t.type)?((0,a.wg)(),(0,a.j4)(ee.x,{key:0,label:d.formatString(t.column),modelValue:e.params[t.column],"onUpdate:modelValue":l=>e.params[t.column]=l,disabled:!e.enabled[t.column]},null,8,["label","modelValue","onUpdate:modelValue","disabled"])):["select"].includes(t.type)?((0,a.wg)(),(0,a.j4)(R.rL,{key:1,label:d.formatString(t.column),items:e.options[t.column],modelValue:e.params[t.column],"onUpdate:modelValue":l=>e.params[t.column]=l,disabled:!e.enabled[t.column]},null,8,["label","items","modelValue","onUpdate:modelValue","disabled"])):["select_multiple"].includes(t.type)?((0,a.wg)(),(0,a.j4)(R.rL,{key:2,label:d.formatString(t.column),items:e.options[t.column],modelValue:e.params[t.column],"onUpdate:modelValue":l=>e.params[t.column]=l,multiple:"",chips:"",disabled:!e.enabled[t.column]},null,8,["label","items","modelValue","onUpdate:modelValue","disabled"])):"combo"===t.type?((0,a.wg)(),(0,a.j4)(Q.f,{key:3,label:d.formatString(t.column),modelValue:e.params[t.column],"onUpdate:modelValue":l=>e.params[t.column]=l,items:e.options[t.column],"onUpdate:search":e=>d.updateCombo(e,t.column),disabled:!e.enabled[t.column]},null,8,["label","modelValue","onUpdate:modelValue","items","onUpdate:search","disabled"])):((0,a.wg)(),(0,a.j4)(le.h,{key:4,label:d.formatString(t.column),modelValue:e.params[t.column],"onUpdate:modelValue":l=>e.params[t.column]=l,disabled:!e.enabled[t.column]},null,8,["label","modelValue","onUpdate:modelValue","disabled"]))])),_:2},1024))],64)))),128))])),_:1}),(0,a.Wm)(r.h,null,{default:(0,a.w5)((()=>[(0,a.Wm)(i.T,{onClick:d.save,variant:"flat",color:"primary",disabled:!d.hasChanges},{default:(0,a.w5)((()=>[(0,a.Uk)("Save")])),_:1},8,["onClick","disabled"])])),_:1})])),_:1},8,["title"])])),_:1},8,["modelValue"])}var oe={props:{section:null,fields:null,vars:null,count:null,defaultData:null},data:function(){return{dialog:!1,error:"",params:{},enabled:{},options:{}}},methods:{open:async function(){this.options=await E.Z.getAllOptions(this.fields,this.vars.options,{}),console.log(this.defaultData),this.params=this.defaultData,this.dialog=!0},formatString:function(e){return E.Z.formatString(e)},save:function(){this.$emit("action","bulkedit",{data:this.params})},updateCombo:async function(e,t){const l=await H.Z.get("?cmd=autocomplete&field="+t+"&term="+e);this.options[t]=l.data}},computed:{hasChanges:function(){return Object.values(this.enabled).filter((e=>!0===e)).length>0}}};const ie=(0,M.Z)(oe,[["render",ae]]);var ne=ie,se={components:{ListButtons:L.Z,draggable:T(),ImportExport:K,BulkEdit:ne},props:{vars:null,section:null,hidebuttons:Boolean,parentsection:null,parentid:null,searchparams:null},data:function(){return{dialog:!1,selectedHeaders:[],headers:[],selected:[],data:{},internalSection:"",loading:!1,sortableDialog:!1,totalItems:0,itemsPerPage:20,page:1,search:"",drag:!1,sortOrder:[],sortOrderLoading:!1,file:[],filter:"",buttonData:{},defaultData:{}}},methods:{formatString:function(e){return E.Z.formatString(e)},loadItems:async function({page:e,itemsPerPage:t,sortBy:l}){let a=this.searchparams;this.filter&&(a["s"]=this.filter);let o={cmd:"get",section:this.internalSection,fields:a,page:e,itemsPerPage:t,sortBy:l,columns:this.selectedHeaders};this.parentsection&&(o.parentsection=this.parentsection),this.parentid&&(o.parentid=this.parentid);const i=Z().stringify(o);this.loading=!0;let n={};try{n=await H.Z.get("?"+i.toString(),o)}catch(d){console.log(d)}if(this.loading=!1,!n.data?.fields)return!1;n.data.data||(n.data.data=[],n.data.total=0),n.data.data.forEach((e=>{for(const[,t]of Object.entries(n.data.fields))e[t.column+"_label"]?e[t.column]=e[t.column+"_label"]:e[t.column]=E.Z.formatData(e[t.column],t.type)})),this.data=n.data,this.totalItems=this.data.total,this.buttonData={page:e,itemsPerPage:t,totalItems:this.totalItems},this.headers=[];let s=Object.values(n.data.fields);if(s.length&&!s.find((e=>"id"===e.column))){let e=E.Z.base();return this.$router.push(e+"section/"+this.internalSection+"/1/"),!1}for(const[,c]of Object.entries(this.data.fields))this.headers.push({title:this.formatString(c.column),key:c.column});let r=s.map((e=>e.column));this.selectedHeaders.length||(this.selectedHeaders=r),this.$emit("changeHeaders",s),this.sortOrder=[],this.isSortable&&(this.data.data.forEach((e=>{let t=Object.keys(e)[0];this.sortOrder.push({title:t+": "+e[t],id:e.id,position:e.position})})),this.sortOrder.sort(((e,t)=>e.position-t.position)));let u=this.vars?.branding?.title?this.vars.branding.title:"ADMIN";document.title=u+" | "+this.internalSection,this.$emit("loaded")},rowClick:function(e,t){let l="/";this.$route.params.base&&(l+=this.$route.params.base+"/");let a=l+"section/"+this.internalSection+"/"+t.item.id+"/";this.parentsection&&(a+="?parentsection="+this.parentsection+"&parentid="+this.parentid),this.$router.push(a)},actionHandler:async function(e){let t={};if("export"===e)return["Basic","Business"].includes(E.Z.getEdition())?void this.$refs["importExport"].exportItems():void this.$router.push(E.Z.base()+"upgrade");if("import"===e)return["Basic","Business"].includes(E.Z.getEdition())?void this.$refs["importExport"].openImport():void this.$router.push(E.Z.base()+"upgrade");if("openBulkEdit"===e){this.defaultData={};let e=0;return this.selected.forEach((t=>{let l=this.data.data.find((e=>t==e.id));for(const[a,o]of Object.entries(l))0===e?this.defaultData[a]=o:this.defaultData[a]!==o&&(this.defaultData[a]=null);e++})),void this.$refs["bulkEdit"].open()}if("openSortable"===e)return void(this.sortableDialog=!0);if("filter"===e)return this.filter=arguments[1],void this.reload();if("prevPage"===e){if(1===this.page)return;return void this.page--}if("nextPage"===e){if(this.page*this.itemsPerPage>=this.totalItems)return;return void this.page++}if("string"===typeof e)return t={cmd:e,section:this.internalSection,ids:this.selected},"object"===typeof arguments[1]&&(t={...t,...arguments[1]}),this.loading=!0,await H.Z.post("?cmd="+e+"&section="+this.internalSection,t),void this.reload();if(!["Basic","Business"].includes(E.Z.getEdition()))return void this.$router.push(E.Z.base()+"upgrade");t={cmd:"button",button:e.id,section:this.internalSection,ids:this.selected},this.loading=!0;const l=await H.Z.post("?cmd=button&section="+this.internalSection,t);this.loading=!1,l.data.error&&alert(l.data.error),l.data.result?.redirect?e.target?window.open(l.data.result.redirect):location.href=l.data.result.redirect:this.reload()},saveSortOrder:async function(){let e={cmd:"reorder",section:this.section,items:this.sortOrder};this.sortOrderLoading=!0,await H.Z.post("?cmd=reorder&section="+this.internalSection,e),this.sortOrderLoading=!1,this.sortableDialog=!1,this.reload()},reload:function(){this.search=String(Date.now())}},watch:{$route(e){this.internalSection=e.params.section,this.reload()},section:function(e){this.internalSection=e,this.reload()},selectedHeaders:function(e,t){if(JSON.stringify(e)!==JSON.stringify(t)&&(localStorage["fields_"+this.internalSection]=JSON.stringify(Object.values(e))),this.data.fields){let t=[];for(const[,l]of Object.entries(this.data.fields))e.includes(l.column)&&t.push(l);this.$emit("changeFields",t)}},searchparams:function(){this.reload()},headers:function(e){let t=localStorage["fields_"+this.internalSection],l=t?JSON.parse(t):e.map((e=>e.key)),a=e.map((e=>e.key));l=l.filter((e=>a.includes(e))),this.selectedHeaders=l}},computed:{activeHeaders:function(){let e=[];return this.data.fields&&Object.values(this.data.fields).forEach((t=>{this.selectedHeaders.includes(t.column)&&e.push({title:this.formatString(t.column),value:t.column,sortable:!0})})),e},isSortable:function(){let e=!1;return this.data.fields&&Object.values(this.data.fields).forEach((t=>{"position"===t.type&&(e=!0)})),e}},created(){this.internalSection=this.section?this.section:this.$route.params.section,localStorage["fields_"+this.internalSection]&&(this.selectedHeaders=JSON.parse(localStorage["fields_"+this.internalSection]))}};const re=(0,M.Z)(se,[["render",j]]);var ue=re},3121:function(e,t,l){l.d(t,{Z:function(){return y}});var a=l(3396),o=l(7103),i=l(2816),n=l(7173),s=l(9114),r=l(8969),u=l(3185),d=l(9637),c=l(8717),m=l(4870),p=l(3766),f=l(131),h=l(1107),g=l(9888);const v=(0,p.U)({chips:Boolean,counter:Boolean,counterSizeString:{type:String,default:"$vuetify.fileInput.counterSize"},counterString:{type:String,default:"$vuetify.fileInput.counter"},multiple:Boolean,showSize:{type:[Boolean,Number,String],default:!1,validator:e=>"boolean"===typeof e||[1e3,1024].includes(Number(e))},...(0,s.c)({prependIcon:"$file"}),modelValue:{type:Array,default:()=>[],validator:e=>(0,f.FT)(e).every((e=>null!=e&&"object"===typeof e))},...(0,n.hy)({clearable:!0})},"VFileInput"),y=(0,h.ev)()({name:"VFileInput",inheritAttrs:!1,props:v(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,t){let{attrs:l,emit:p,slots:h}=t;const{t:v}=(0,d.bU)(),y=(0,c.z)(e,"modelValue"),{isFocused:b,focus:S,blur:w}=(0,r.K)(e),k=(0,a.Fl)((()=>"boolean"!==typeof e.showSize?e.showSize:void 0)),V=(0,a.Fl)((()=>(y.value??[]).reduce(((e,t)=>{let{size:l=0}=t;return e+l}),0))),x=(0,a.Fl)((()=>(0,f.XE)(V.value,k.value))),I=(0,a.Fl)((()=>(y.value??[]).map((t=>{const{name:l="",size:a=0}=t;return e.showSize?`${l} (${(0,f.XE)(a,k.value)})`:l})))),C=(0,a.Fl)((()=>{const t=y.value?.length??0;return e.showSize?v(e.counterSizeString,t,x.value):v(e.counterString,t)})),W=(0,m.iH)(),P=(0,m.iH)(),$=(0,m.iH)(),B=(0,a.Fl)((()=>b.value||e.active)),D=(0,a.Fl)((()=>["plain","underlined"].includes(e.variant)));function _(){$.value!==document.activeElement&&$.value?.focus(),b.value||S()}function F(e){j(e)}function U(e){p("mousedown:control",e)}function j(e){$.value?.click(),p("click:control",e)}function H(t){t.stopPropagation(),_(),(0,a.Y3)((()=>{y.value=[],(0,f.dr)(e["onClick:clear"],t)}))}return(0,a.YP)(y,(e=>{const t=!Array.isArray(e)||!e.length;t&&$.value&&($.value.value="")})),(0,g.L)((()=>{const t=!(!h.counter&&!e.counter),r=!(!t&&!h.details),[u,d]=(0,f.An)(l),{modelValue:c,...m}=s.q.filterProps(e),p=(0,n.g8)(e);return(0,a.Wm)(s.q,(0,a.dG)({ref:W,modelValue:y.value,"onUpdate:modelValue":e=>y.value=e,class:["v-file-input",{"v-file-input--chips":!!e.chips,"v-input--plain-underlined":D.value},e.class],style:e.style,"onClick:prepend":F},u,m,{centerAffix:!D.value,focused:b.value}),{...h,default:t=>{let{id:l,isDisabled:i,isDirty:s,isReadonly:r,isValid:u}=t;return(0,a.Wm)(n.hF,(0,a.dG)({ref:P,"prepend-icon":e.prependIcon,onMousedown:U,onClick:j,"onClick:clear":H,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},p,{id:l.value,active:B.value||s.value,dirty:s.value,disabled:i.value,focused:b.value,error:!1===u.value}),{...h,default:t=>{let{props:{class:l,...n}}=t;return(0,a.Wm)(a.HY,null,[(0,a.Wm)("input",(0,a.dG)({ref:$,type:"file",readonly:r.value,disabled:i.value,multiple:e.multiple,name:e.name,onClick:e=>{e.stopPropagation(),r.value&&e.preventDefault(),_()},onChange:e=>{if(!e.target)return;const t=e.target;y.value=[...t.files??[]]},onFocus:_,onBlur:w},n,d),null),(0,a.Wm)("div",{class:l},[!!y.value?.length&&(h.selection?h.selection({fileNames:I.value,totalBytes:V.value,totalBytesReadable:x.value}):e.chips?I.value.map((t=>(0,a.Wm)(o.v,{key:t,size:"small",color:e.color},{default:()=>[t]}))):I.value.join(", "))])])}})},details:r?e=>(0,a.Wm)(a.HY,null,[h.details?.(e),t&&(0,a.Wm)(a.HY,null,[(0,a.Wm)("span",null,null),(0,a.Wm)(i._,{active:!!y.value?.length,value:C.value},h.counter)])]):void 0})})),(0,u.F)({},W,P,$)}})},8521:function(e,t,l){l.d(t,{D:function(){return v}});l(560),l(8099);var a=l(9166),o=l(8157),i=l(1138),n=l(7139),s=l(3396),r=l(3766),u=l(1107);const d=(()=>o.AV.reduce(((e,t)=>(e[t]={type:[Boolean,String,Number],default:!1},e)),{}))(),c=(()=>o.AV.reduce(((e,t)=>{const l="offset"+(0,n.kC)(t);return e[l]={type:[String,Number],default:null},e}),{}))(),m=(()=>o.AV.reduce(((e,t)=>{const l="order"+(0,n.kC)(t);return e[l]={type:[String,Number],default:null},e}),{}))(),p={col:Object.keys(d),offset:Object.keys(c),order:Object.keys(m)};function f(e,t,l){let a=e;if(null!=l&&!1!==l){if(t){const l=t.replace(e,"");a+=`-${l}`}return"col"===e&&(a="v-"+a),"col"!==e||""!==l&&!0!==l?(a+=`-${l}`,a.toLowerCase()):a.toLowerCase()}}const h=["auto","start","end","center","baseline","stretch"],g=(0,r.U)({cols:{type:[Boolean,String,Number],default:!1},...d,offset:{type:[String,Number],default:null},...c,order:{type:[String,Number],default:null},...m,alignSelf:{type:String,default:null,validator:e=>h.includes(e)},...(0,a.l)(),...(0,i.Q)()},"VCol"),v=(0,u.ev)()({name:"VCol",props:g(),setup(e,t){let{slots:l}=t;const a=(0,s.Fl)((()=>{const t=[];let l;for(l in p)p[l].forEach((a=>{const o=e[a],i=f(l,a,o);i&&t.push(i)}));const a=t.some((e=>e.startsWith("v-col-")));return t.push({"v-col":!a||!e.cols,[`v-col-${e.cols}`]:e.cols,[`offset-${e.offset}`]:e.offset,[`order-${e.order}`]:e.order,[`align-self-${e.alignSelf}`]:e.alignSelf}),t}));return()=>(0,s.h)(e.tag,{class:[a.value,e.class],style:e.style},l.default?.())}})},7396:function(e,t,l){l.d(t,{$Y:function(){return f},GB:function(){return m},eW:function(){return h},o8:function(){return p},te:function(){return v}});l(560);var a=l(3712),o=l(3396),i=l(4870),n=l(3766),s=l(7514),r=l(131);const u=Symbol.for("vuetify:layout"),d=Symbol.for("vuetify:layout-item"),c=1e3,m=(0,n.U)({overlaps:{type:Array,default:()=>[]},fullHeight:Boolean},"layout"),p=(0,n.U)({name:{type:String},order:{type:[Number,String],default:0},absolute:Boolean},"layout-item");function f(){const e=(0,o.f3)(u);if(!e)throw new Error("[Vuetify] Could not find injected layout");return{getLayoutItem:e.getLayoutItem,mainRect:e.mainRect,mainStyles:e.mainStyles}}function h(e){const t=(0,o.f3)(u);if(!t)throw new Error("[Vuetify] Could not find injected layout");const l=e.id??`layout-item-${(0,s.sq)()}`,a=(0,s.FN)("useLayoutItem");(0,o.JJ)(d,{id:l});const n=(0,i.XI)(!1);(0,o.se)((()=>n.value=!0)),(0,o.dl)((()=>n.value=!1));const{layoutItemStyles:r,layoutItemScrimStyles:c}=t.register(a,{...e,active:(0,o.Fl)((()=>!n.value&&e.active.value)),id:l});return(0,o.Jd)((()=>t.unregister(l))),{layoutItemStyles:r,layoutRect:t.layoutRect,layoutItemScrimStyles:c}}const g=(e,t,l,a)=>{let o={top:0,left:0,right:0,bottom:0};const i=[{id:"",layer:{...o}}];for(const n of e){const e=t.get(n),s=l.get(n),r=a.get(n);if(!e||!s||!r)continue;const u={...o,[e.value]:parseInt(o[e.value],10)+(r.value?parseInt(s.value,10):0)};i.push({id:n,layer:u}),o=u}return i};function v(e){const t=(0,o.f3)(u,null),l=(0,o.Fl)((()=>t?t.rootZIndex.value-100:c)),n=(0,i.iH)([]),m=(0,i.qj)(new Map),p=(0,i.qj)(new Map),f=(0,i.qj)(new Map),h=(0,i.qj)(new Map),v=(0,i.qj)(new Map),{resizeRef:y,contentRect:b}=(0,a.y)(),S=(0,o.Fl)((()=>{const t=new Map,l=e.overlaps??[];for(const e of l.filter((e=>e.includes(":")))){const[l,a]=e.split(":");if(!n.value.includes(l)||!n.value.includes(a))continue;const o=m.get(l),i=m.get(a),s=p.get(l),r=p.get(a);o&&i&&s&&r&&(t.set(a,{position:o.value,amount:parseInt(s.value,10)}),t.set(l,{position:i.value,amount:-parseInt(r.value,10)}))}return t})),w=(0,o.Fl)((()=>{const e=[...new Set([...f.values()].map((e=>e.value)))].sort(((e,t)=>e-t)),t=[];for(const l of e){const e=n.value.filter((e=>f.get(e)?.value===l));t.push(...e)}return g(t,m,p,h)})),k=(0,o.Fl)((()=>!Array.from(v.values()).some((e=>e.value)))),V=(0,o.Fl)((()=>w.value[w.value.length-1].layer)),x=(0,o.Fl)((()=>({"--v-layout-left":(0,r.kb)(V.value.left),"--v-layout-right":(0,r.kb)(V.value.right),"--v-layout-top":(0,r.kb)(V.value.top),"--v-layout-bottom":(0,r.kb)(V.value.bottom),...k.value?void 0:{transition:"none"}}))),I=(0,o.Fl)((()=>w.value.slice(1).map(((e,t)=>{let{id:l}=e;const{layer:a}=w.value[t],o=p.get(l),i=m.get(l);return{id:l,...a,size:Number(o.value),position:i.value}})))),C=e=>I.value.find((t=>t.id===e)),W=(0,s.FN)("createLayout"),P=(0,i.XI)(!1);(0,o.bv)((()=>{P.value=!0})),(0,o.JJ)(u,{register:(e,t)=>{let{id:a,order:i,position:s,layoutSize:u,elementSize:g,active:y,disableTransitions:b,absolute:V}=t;f.set(a,i),m.set(a,s),p.set(a,u),h.set(a,y),b&&v.set(a,b);const x=(0,r.bY)(d,W?.vnode),C=x.indexOf(e);C>-1?n.value.splice(C,0,a):n.value.push(a);const $=(0,o.Fl)((()=>I.value.findIndex((e=>e.id===a)))),B=(0,o.Fl)((()=>l.value+2*w.value.length-2*$.value)),D=(0,o.Fl)((()=>{const e="left"===s.value||"right"===s.value,t="right"===s.value,o="bottom"===s.value,i={[s.value]:0,zIndex:B.value,transform:`translate${e?"X":"Y"}(${(y.value?0:-110)*(t||o?-1:1)}%)`,position:V.value||l.value!==c?"absolute":"fixed",...k.value?void 0:{transition:"none"}};if(!P.value)return i;const n=I.value[$.value];if(!n)throw new Error(`[Vuetify] Could not find layout item "${a}"`);const r=S.value.get(a);return r&&(n[r.position]+=r.amount),{...i,height:e?`calc(100% - ${n.top}px - ${n.bottom}px)`:g.value?`${g.value}px`:void 0,left:t?void 0:`${n.left}px`,right:t?`${n.right}px`:void 0,top:"bottom"!==s.value?`${n.top}px`:void 0,bottom:"top"!==s.value?`${n.bottom}px`:void 0,width:e?g.value?`${g.value}px`:void 0:`calc(100% - ${n.left}px - ${n.right}px)`}})),_=(0,o.Fl)((()=>({zIndex:B.value-1})));return{layoutItemStyles:D,layoutItemScrimStyles:_,zIndex:B}},unregister:e=>{f.delete(e),m.delete(e),p.delete(e),h.delete(e),v.delete(e),n.value=n.value.filter((t=>t!==e))},mainRect:V,mainStyles:x,getLayoutItem:C,items:I,layoutRect:b,rootZIndex:l});const $=(0,o.Fl)((()=>["v-layout",{"v-layout--full-height":e.fullHeight}])),B=(0,o.Fl)((()=>({zIndex:t?l.value:void 0,position:t?"relative":void 0,overflow:t?"hidden":void 0})));return{layoutClasses:$,layoutStyles:B,getLayoutItem:C,items:I,layoutRect:b,layoutRef:y}}}}]);
//# sourceMappingURL=62.4ed61c19.js.map