"use strict";(self["webpackChunkshiftadmin"]=self["webpackChunkshiftadmin"]||[]).push([[794],{5089:function(e,t,a){a.d(t,{A:function(){return b}});var l=a(56768),i=a(24232),o=a(13892),n=a(41720),s=a(35526),r=a(69915),d=a(57254),u=a(4913),c=a(88249);const m={class:"d-flex w-100 align-center"};function p(e,t,a,p,h,f){return(0,l.uX)(),(0,l.CE)("span",m,[(0,l.bF)(o.D,{variant:"text",title:"Add",icon:"mdi-plus",to:f.base+"section/"+e.internalSection+"/add"+(a.parentsection?"?parentsection="+a.parentsection+"&parentid="+a.parentid:"")},null,8,["to"]),(0,l.bF)(o.D,{variant:"text",title:"Fields",icon:"mdi-view-column",color:"grey-lighten-1",onClick:f.changeFields},null,8,["onClick"]),a.selected.length?((0,l.uX)(),(0,l.Wv)(o.D,{key:0,variant:"text",title:"Bulk Edit",icon:"mdi-pencil",color:"grey-lighten-1",onClick:t[0]||(t[0]=e=>f.doAction("openBulkEdit"))})):(0,l.Q3)("",!0),a.selected.length?((0,l.uX)(),(0,l.Wv)(o.D,{key:1,variant:"text",title:"Delete",icon:"mdi-delete",color:"grey-lighten-1",onClick:t[1]||(t[1]=e=>f.doAction("delete"))})):(0,l.Q3)("",!0),(0,l.bF)(o.D,{variant:"text",title:"Import",icon:"mdi-import",color:"grey-lighten-1",onClick:f.openImport},null,8,["onClick"]),(0,l.bF)(o.D,{variant:"text",title:"Export",icon:"mdi-export",color:"grey-lighten-1",onClick:f.exportItems},null,8,["onClick"]),a.sortable?((0,l.uX)(),(0,l.Wv)(o.D,{key:2,variant:"text",title:"Sort",icon:"mdi-sort",color:"grey-lighten-1",onClick:t[2]||(t[2]=e=>f.doAction("openSortable"))})):(0,l.Q3)("",!0),f.buttons.length?((0,l.uX)(),(0,l.Wv)(c.q,{key:3},{activator:(0,l.k6)((({props:e})=>[(0,l.bF)(o.D,(0,l.v6)({variant:"text"},e,{icon:"mdi-dots-vertical"}),null,16)])),default:(0,l.k6)((()=>[(0,l.bF)(r.x8,null,{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(f.buttons,((e,t)=>((0,l.uX)(),(0,l.Wv)(d.g,{key:t,value:t,onClick:t=>f.customButton(e)},{default:(0,l.k6)((()=>[(0,l.bF)(u.U,null,{default:(0,l.k6)((()=>[(0,l.eW)((0,i.v_)(e.label),1)])),_:2},1024)])),_:2},1032,["value","onClick"])))),128))])),_:1})])),_:1})):(0,l.Q3)("",!0),(0,l.bF)(n.h),a.mobile?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(s.B,{key:4,class:"text-grey-lighten-1 text-right"},{default:(0,l.k6)((()=>[(0,l.eW)((0,i.v_)(parseInt((a.data.page-1)*a.data.itemsPerPage+1)?.toLocaleString())+"-"+(0,i.v_)(Math.min(a.data.page*a.data.itemsPerPage,a.data.totalItems)?.toLocaleString())+" of "+(0,i.v_)(a.data.totalItems?.toLocaleString()),1)])),_:1})),(0,l.bF)(o.D,{variant:"text",icon:"mdi-chevron-left",disabled:1===a.data.page,onClick:f.prevPage},null,8,["disabled","onClick"]),(0,l.bF)(o.D,{variant:"text",icon:"mdi-chevron-right",disabled:a.data.page*a.data.itemsPerPage>=a.data.totalItems,onClick:f.nextPage},null,8,["disabled","onClick"])])}a(44114);var h={props:{vars:null,section:null,hidebuttons:Boolean,parentsection:null,parentid:null,searchparams:null,selected:null,data:null,headers:null,mobile:null,sortable:Boolean},data:function(){return{dialog:!1,selectedHeaders:[],internalSection:"",loading:!1,filter:""}},methods:{formatString:function(e){return e=e.replace(/_/g," "),e.charAt(0).toUpperCase()+e.slice(1)},doAction:async function(e){this.$emit("action",e)},exportItems:function(){this.$emit("action","export")},changeFields:function(){this.$emit("changeFields")},customButton:function(e){this.$emit("action",e)},openImport:function(){this.$emit("action","import")},prevPage:function(){this.$emit("action","prevPage")},nextPage:function(){this.$emit("action","nextPage")}},watch:{section:function(e){this.internalSection=e},filter:function(e){this.$emit("action","filter",e)}},computed:{buttons:function(){let e=[];return this.vars?.buttons?.forEach(((t,a)=>{"list"===t.page&&t.section===this.internalSection&&(t.id=a,e.push(t))})),e},base(){let e="/";return this.$route.params.base&&(e+=this.$route.params.base+"/"),e}},created(){this.internalSection=this.section?this.section:this.$route.params.section}},f=a(71241);const g=(0,f.A)(h,[["render",p]]);var b=g},41794:function(e,t,a){a.r(t),a.d(t,{default:function(){return Y}});var l=a(56768),i=a(45130),o=a(24232),n=a(31969),s=a(13892),r=a(4189),d=a(30697),u=a(93745),c=a(86852),m=a(771),p=a(47697),h=a(91772),f=a(67020),g=a(62598),b=a(51146);const v=["onClick"],k={class:"v-data-table__td v-data-table-column--no-padding v-data-table-column--align-start",style:{width:"48px"}},y={key:0},S={key:1},C={key:2},F={key:3},_={key:4};function V(e,t,a,V,x,A){const D=(0,l.g2)("ListButtons"),E=(0,l.g2)("ImportExport"),w=(0,l.g2)("BulkEdit"),O=(0,l.g2)("draggable");return(0,l.uX)(),(0,l.Wv)(g.L,null,{default:(0,l.k6)((()=>[(0,l.bF)(m.u,{modelValue:e.selected,"onUpdate:modelValue":t[1]||(t[1]=t=>e.selected=t),headers:A.activeHeaders,items:e.data.data,"item-value":"id","show-select":"","onClick:row":A.rowClick,loading:e.loading,"onUpdate:options":A.loadItems,"items-length":e.totalItems,"items-per-page":e.itemsPerPage,"onUpdate:itemsPerPage":t[2]||(t[2]=t=>e.itemsPerPage=t),search:e.search,"fixed-header":"","fixed-footer":"",class:"data-table-server",page:e.page,"sort-by":e.sortBy,"onUpdate:sortBy":[t[3]||(t[3]=t=>e.sortBy=t),A.updateSortBy]},{top:(0,l.k6)((()=>[e.error?((0,l.uX)(),(0,l.Wv)(n.l,{key:0,title:e.error,type:"error",style:{"max-height":"60px"}},null,8,["title"])):(0,l.Q3)("",!0),(0,l.bF)(b.i,{color:"secondary",class:"w-100"},{default:(0,l.k6)((()=>[a.hidebuttons?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(D,{key:0,selected:e.selected,section:e.internalSection,onChangeFields:t[0]||(t[0]=t=>e.dialog=!0),onAction:A.actionHandler,vars:a.vars,sortable:A.isSortable,data:e.buttonData,mobile:a.mobile},null,8,["selected","section","onAction","vars","sortable","data","mobile"]))])),_:1})])),item:(0,l.k6)((({item:t,internalItem:n,isSelected:s,toggleSelect:r})=>[(0,l.Lk)("tr",{class:"v-data-table__tr v-data-table__tr--clickable",onClick:e=>A.rowClick(e,t)},[(0,l.Lk)("td",k,[(0,l.bF)(c.M,{"model-value":s(n),"hide-details":"",onClick:(0,i.D$)((e=>r(n,!s(n))),["stop"])},null,8,["model-value","onClick"])]),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(A.activeHeaders,(i=>((0,l.uX)(),(0,l.CE)("td",{key:i,class:"v-data-table__td v-data-table-column--align-start"},[["upload","file","files","uploads"].includes(A.getFieldType(i.value))?((0,l.uX)(),(0,l.CE)("span",y,[(0,l.bF)(f.y,{src:e.apiRoot+"?cmd=file&f="+(Array.isArray(t[i.value])?t[i.value][0]:t[i.value])+"&w=320&h=240",style:{"max-width":"160px","max-height":"120px"}},null,8,["src"])])):["select_multiple"].includes(A.getFieldType(i.value))?((0,l.uX)(),(0,l.CE)("span",S,(0,o.v_)(Array.isArray(t[i.value])?t[i.value].length+" items":""),1)):["select"].includes(A.getFieldType(i.value))&&"object"===typeof a.vars.options?.[i.value]?((0,l.uX)(),(0,l.CE)("span",C,(0,o.v_)(a.vars.options[i.value][t[i.value]]||t[i.value]),1)):t[i.value]&&["editor"].includes(A.getFieldType(i.value))?((0,l.uX)(),(0,l.CE)("span",F,(0,o.v_)(t[i.value].replace(/(<([^>]+)>)/gi,"")),1)):((0,l.uX)(),(0,l.CE)("span",_,(0,o.v_)(A.formatData(t[i.value],A.getFieldType(i.value))),1))])))),128))],8,v)])),bottom:(0,l.k6)((()=>[])),_:1},8,["modelValue","headers","items","onClick:row","loading","onUpdate:options","items-length","items-per-page","search","page","sort-by","onUpdate:sortBy"]),(0,l.bF)(E,{ref:"importExport",headers:e.headers,section:e.internalSection,fields:a.searchparams,columns:e.selectedHeaders,onReload:A.reload},null,8,["headers","section","fields","columns","onReload"]),(0,l.bF)(w,{ref:"bulkEdit",section:e.internalSection,fields:e.data?.fields,onAction:A.actionHandler,vars:a.vars,count:e.selected.length,defaultData:e.defaultData},null,8,["section","fields","onAction","vars","count","defaultData"]),(0,l.bF)(h.p,{modelValue:e.dialog,"onUpdate:modelValue":t[5]||(t[5]=t=>e.dialog=t),"max-width":"600",scrollable:""},{default:(0,l.k6)((()=>[(0,l.bF)(r.J,{title:"Fields"},{default:(0,l.k6)((()=>[(0,l.bF)(p.Py,{modelValue:e.selectedHeaders,"onUpdate:modelValue":t[4]||(t[4]=t=>e.selectedHeaders=t),headers:[{title:"Field",key:"title"}],items:e.headers,"item-value":"key","items-per-page":"-1","show-select":""},{bottom:(0,l.k6)((()=>[])),_:1},8,["modelValue","items"])])),_:1})])),_:1},8,["modelValue"]),(0,l.bF)(h.p,{modelValue:e.sortableDialog,"onUpdate:modelValue":t[9]||(t[9]=t=>e.sortableDialog=t),"max-width":"600",scrollable:""},{default:(0,l.k6)((()=>[(0,l.bF)(r.J,{title:"Sort Order",loading:e.sortOrderLoading},{default:(0,l.k6)((()=>[(0,l.bF)(d.O,null,{default:(0,l.k6)((()=>[(0,l.bF)(O,{modelValue:e.sortOrder,"onUpdate:modelValue":t[6]||(t[6]=t=>e.sortOrder=t),group:"items",onStart:t[7]||(t[7]=t=>e.drag=!0),onEnd:t[8]||(t[8]=t=>e.drag=!1),"item-key":"id"},{item:(0,l.k6)((({element:e})=>[(0,l.bF)(b.i,{color:"primary",class:"ma-5 pa-5"},{default:(0,l.k6)((()=>[(0,l.eW)((0,o.v_)(e.title),1)])),_:2},1024)])),_:1},8,["modelValue"])])),_:1}),(0,l.bF)(u.S,null,{default:(0,l.k6)((()=>[(0,l.bF)(s.D,{variant:"flat",color:"primary",onClick:A.saveSortOrder},{default:(0,l.k6)((()=>[(0,l.eW)("Save")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["loading"])])),_:1},8,["modelValue"])])),_:1})}a(44114);var x=a(74300),A=a(27274),D=a(19122),E=a.n(D),w=a(5089),O=a(61527),P=a.n(O),I=a(78351),X=a(20105);const U={key:1},$=(0,l.Lk)("h4",null,"Match up the fields",-1);function B(e,t,a,i,o,c){return(0,l.uX)(),(0,l.Wv)(h.p,{modelValue:e.importDialog,"onUpdate:modelValue":t[1]||(t[1]=t=>e.importDialog=t),"max-width":"600",scrollable:""},{default:(0,l.k6)((()=>[(0,l.bF)(r.J,{title:"Import"},{default:(0,l.k6)((()=>[(0,l.bF)(d.O,null,{default:(0,l.k6)((()=>[e.error?((0,l.uX)(),(0,l.Wv)(n.l,{key:0,text:e.error,type:"error"},null,8,["text"])):(0,l.Q3)("",!0),(0,l.bF)(I.f,{modelValue:e.file,"onUpdate:modelValue":[t[0]||(t[0]=t=>e.file=t),c.readFile],label:"CSV file"},null,8,["modelValue","onUpdate:modelValue"]),e.importHeaders.length?((0,l.uX)(),(0,l.CE)("div",U,[$,((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(a.headers,((t,a)=>((0,l.uX)(),(0,l.CE)("div",{key:a},[(0,l.bF)(X.d4,{items:e.importHeaders,label:t.title,modelValue:e.importCols[t.key],"onUpdate:modelValue":a=>e.importCols[t.key]=a},null,8,["items","label","modelValue","onUpdate:modelValue"])])))),128))])):(0,l.Q3)("",!0)])),_:1}),(0,l.bF)(u.S,null,{default:(0,l.k6)((()=>[(0,l.bF)(s.D,{onClick:c.doImport,variant:"flat",color:"primary",disabled:!e.importHeaders.length},{default:(0,l.k6)((()=>[(0,l.eW)("Import")])),_:1},8,["onClick","disabled"])])),_:1})])),_:1})])),_:1},8,["modelValue"])}var W={props:{headers:null,section:null,fields:null,columns:null},data:function(){return{error:"",importDialog:!1,importHeaders:[],importCols:{}}},methods:{openImport:function(){this.importDialog=!0},doImport:async function(){const e=new FormData;for(const[a,l]of Object.entries(this.importCols))e.append("fields["+a+"]",l);e.append("file",this.file[0]),this.error="",this.loading=!0;const t=await x.A.post("?cmd=import&section="+this.internalSection,e,{headers:{"Content-Type":"multipart/form-data"}});this.loading=!1,t.data.error?this.error=t.data?.error:(this.importDialog=!1,this.$emit("reload"))},readFile:function(){const e=new FileReader;e.onload=e=>{const t=e.target.result,a=t.split("\n");let l=[],i=a[0].split(",");for(let n=0;n<i.length;n++){const e=i[n].trim();e.startsWith('"')&&e.endsWith('"')?l.push(e.slice(1,-1)):l.push(e)}let o=[];i=a[1].split(",");for(let n=0;n<i.length;n++){const e=i[n].trim();e.startsWith('"')&&e.endsWith('"')?o.push(e.slice(1,-1)):o.push(e)}this.importHeaders=[],l.forEach(((e,t)=>{this.importHeaders.push({value:t,raw:e,title:e+" - "+o[t]})})),this.importCols={},this.headers.forEach((e=>{let t=this.importHeaders.find((t=>t.raw===e.key));this.importCols[e.key]=t?t.value:""}))},e.readAsText(this.file[0])},exportItems:function(){let e={cmd:"export",section:this.section,fields:this.fields,columns:this.columns};const t=E().stringify(e);window.open(x.A.getApiRoot()+"?"+t)}}},H=a(71241);const j=(0,H.A)(W,[["render",B]]);var L=j,T=a(92239),J=a(40276),Q=a(57254),N=a(43948);function R(e,t,a,i,o,c){return(0,l.uX)(),(0,l.Wv)(h.p,{modelValue:e.dialog,"onUpdate:modelValue":t[0]||(t[0]=t=>e.dialog=t),"max-width":"600",scrollable:""},{default:(0,l.k6)((()=>[(0,l.bF)(r.J,{title:"Editing "+a.count+" files"},{default:(0,l.k6)((()=>[(0,l.bF)(d.O,null,{default:(0,l.k6)((()=>[e.error?((0,l.uX)(),(0,l.Wv)(n.l,{key:0,text:e.error,type:"error"},null,8,["text"])):(0,l.Q3)("",!0),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(a.fields,(t=>((0,l.uX)(),(0,l.CE)(l.FK,{key:t.type},[["id"].includes(t.type)?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(Q.g,{key:0},{prepend:(0,l.k6)((()=>[(0,l.bF)(J.a,{modelValue:e.enabled[t.column],"onUpdate:modelValue":a=>e.enabled[t.column]=a},null,8,["modelValue","onUpdate:modelValue"])])),default:(0,l.k6)((()=>[["checkbox"].includes(t.type)?((0,l.uX)(),(0,l.Wv)(J.a,{key:0,label:c.formatString(t.column),modelValue:e.params[t.column],"onUpdate:modelValue":a=>e.params[t.column]=a,disabled:!e.enabled[t.column]},null,8,["label","modelValue","onUpdate:modelValue","disabled"])):["select"].includes(t.type)?((0,l.uX)(),(0,l.Wv)(X.d4,{key:1,label:c.formatString(t.column),items:e.options[t.column],modelValue:e.params[t.column],"onUpdate:modelValue":a=>e.params[t.column]=a,disabled:!e.enabled[t.column]},null,8,["label","items","modelValue","onUpdate:modelValue","disabled"])):["select_multiple"].includes(t.type)?((0,l.uX)(),(0,l.Wv)(X.d4,{key:2,label:c.formatString(t.column),items:e.options[t.column],modelValue:e.params[t.column],"onUpdate:modelValue":a=>e.params[t.column]=a,multiple:"",chips:"",disabled:!e.enabled[t.column]},null,8,["label","items","modelValue","onUpdate:modelValue","disabled"])):"combo"===t.type?((0,l.uX)(),(0,l.Wv)(T.V,{key:3,label:c.formatString(t.column),modelValue:e.params[t.column],"onUpdate:modelValue":a=>e.params[t.column]=a,items:e.options[t.column],"onUpdate:search":e=>c.updateCombo(e,t.column),disabled:!e.enabled[t.column]},null,8,["label","modelValue","onUpdate:modelValue","items","onUpdate:search","disabled"])):((0,l.uX)(),(0,l.Wv)(N.W,{key:4,label:c.formatString(t.column),modelValue:e.params[t.column],"onUpdate:modelValue":a=>e.params[t.column]=a,disabled:!e.enabled[t.column]},null,8,["label","modelValue","onUpdate:modelValue","disabled"]))])),_:2},1024))],64)))),128))])),_:1}),(0,l.bF)(u.S,null,{default:(0,l.k6)((()=>[(0,l.bF)(s.D,{onClick:c.save,variant:"flat",color:"primary",disabled:!c.hasChanges},{default:(0,l.k6)((()=>[(0,l.eW)("Save")])),_:1},8,["onClick","disabled"])])),_:1})])),_:1},8,["title"])])),_:1},8,["modelValue"])}var K={props:{section:null,fields:null,vars:null,count:null,defaultData:null},data:function(){return{dialog:!1,error:"",params:{},enabled:{},options:{}}},methods:{open:async function(){this.options=await A.A.getAllOptions(this.fields,this.vars.options,{}),console.log(this.defaultData),this.params=this.defaultData,this.dialog=!0},formatString:function(e){return A.A.formatString(e)},save:function(){this.$emit("action","bulkedit",{data:this.params}),this.dialog=!1},updateCombo:async function(e,t){const a=await x.A.get("?cmd=autocomplete&field="+t+"&term="+e);this.options[t]=a.data}},computed:{hasChanges:function(){return Object.values(this.enabled).filter((e=>!0===e)).length>0}}};const M=(0,H.A)(K,[["render",R]]);var q=M,z={components:{ListButtons:w.A,draggable:P(),ImportExport:L,BulkEdit:q},props:{vars:null,section:null,hidebuttons:Boolean,parentsection:null,parentid:null,searchparams:null,mobile:null},data:function(){return{dialog:!1,selectedHeaders:[],headers:[],selected:[],data:{},internalSection:"",loading:!1,sortableDialog:!1,totalItems:0,itemsPerPage:20,page:1,search:"",drag:!1,sortOrder:[],sortOrderLoading:!1,file:[],filter:"",buttonData:{},defaultData:{},sortBy:[],error:""}},methods:{formatString:function(e){return A.A.formatString(e)},loadItems:async function({page:e,itemsPerPage:t,sortBy:a}){let l=this.searchparams;this.filter&&(l["s"]=this.filter);let i={cmd:"get",section:this.internalSection,fields:l,page:e,itemsPerPage:t,sortBy:a,columns:this.selectedHeaders};this.parentsection&&(i.parentsection=this.parentsection),this.parentid&&(i.parentid=this.parentid);const o=E().stringify(i);this.loading=!0,this.error="";let n={};try{n=await x.A.get("?"+o.toString(),i)}catch(c){console.log(c)}if(n.data.error&&(this.error=n.data.error),this.loading=!1,!n.data?.fields)return!1;n.data.data||(n.data.data=[],n.data.total=0),n.data.data.forEach((e=>{for(const[,t]of Object.entries(n.data.fields))e[t.column+"_label"]&&(e[t.column]=e[t.column+"_label"])})),this.data=n.data,this.totalItems=this.data.total,this.buttonData={page:e,itemsPerPage:t,totalItems:this.totalItems};let s=[],r=Object.values(n.data.fields);if(r.length&&!r.find((e=>"id"===e.column))){let e=A.A.base();return this.$router.push(e+"section/"+this.internalSection+"/1/"),!1}for(const[,m]of Object.entries(this.data.fields))s.push({title:this.formatString(m.column),key:m.column});this.headers=s,await this.$nextTick();let d=r.map((e=>e.column));this.selectedHeaders.length||(this.selectedHeaders=d),this.$emit("changeHeaders",r),this.sortOrder=[],this.isSortable&&(this.data.data.forEach((e=>{let t=Object.keys(e)[0];this.sortOrder.push({title:t+": "+e[t],id:e.id,position:e.position})})),this.sortOrder.sort(((e,t)=>e.position-t.position)));let u=this.vars?.branding?.title?this.vars.branding.title:"ADMIN";document.title=u+" | "+this.formatString(this.internalSection),await this.$nextTick(),this.$emit("updateCount",this.data),this.$emit("loaded")},rowClick:function(e,t){let a="/";this.$route.params.base&&(a+=this.$route.params.base+"/");let l=a+"section/"+this.internalSection+"/"+t.id+"/";this.parentsection&&(l+="?parentsection="+this.parentsection+"&parentid="+this.parentid),this.$router.push(l)},actionHandler:async function(e){let t={};if("export"===e)return["Pro","Business","Trial"].includes(A.A.getEdition())?void this.$refs["importExport"].exportItems():void this.$router.push(A.A.base()+"upgrade");if("import"===e)return["Pro","Business","Trial"].includes(A.A.getEdition())?void this.$refs["importExport"].openImport():void this.$router.push(A.A.base()+"upgrade");if("openBulkEdit"===e){this.defaultData={};let e=0;return this.selected.forEach((t=>{let a=this.data.data.find((e=>t==e.id));for(const[l,i]of Object.entries(a))0===e?this.defaultData[l]=i:this.defaultData[l]!==i&&(this.defaultData[l]=null);e++})),void this.$refs["bulkEdit"].open()}if("openSortable"===e)return void(this.sortableDialog=!0);if("filter"===e)return this.filter=arguments[1],void this.reload();if("prevPage"===e){if(1===this.page)return;return void this.page--}if("nextPage"===e){if(this.page*this.itemsPerPage>=this.totalItems)return;return void this.page++}if("string"===typeof e){t={cmd:e,section:this.internalSection,ids:this.selected},"object"===typeof arguments[1]&&(t={...t,...arguments[1]}),this.loading=!0;const a=await x.A.post("?cmd="+e+"&section="+this.internalSection,t);return this.loading=!1,void(a.data.error?this.error=a.data.error:this.reload())}if(!["Pro","Business","Trial"].includes(A.A.getEdition()))return void this.$router.push(A.A.base()+"upgrade");t={cmd:"button",button:e.id,section:this.internalSection,ids:this.selected},this.loading=!0;const a=await x.A.post("?cmd=button&section="+this.internalSection,t);this.loading=!1,a.data.error&&(this.error=a.data.error),a.data.result?.redirect?e.target?window.open(a.data.result.redirect):location.href=a.data.result.redirect:this.reload()},saveSortOrder:async function(){let e={cmd:"reorder",section:this.section,items:this.sortOrder};this.sortOrderLoading=!0,await x.A.post("?cmd=reorder&section="+this.internalSection,e),this.sortOrderLoading=!1,this.sortableDialog=!1,this.reload()},reload:function(){this.search=String(Date.now())},updateSortBy:function(e){localStorage["sortBy_"+this.internalSection]=JSON.stringify(e)},getFieldType:function(e){return this.data?.fields[e.replaceAll("_"," ")]?.type},formatData:function(e,t){return A.A.formatData(e,t)}},watch:{internalSection:function(e){localStorage["fields_"+e]?this.selectedHeaders=JSON.parse(localStorage["fields_"+e]):this.selectedHeaders=[],localStorage["sortBy_"+e]?this.sortBy=JSON.parse(localStorage["sortBy_"+e]):this.sortBy=[]},$route(e){this.internalSection=e.params.section,this.reload()},section:function(e){this.internalSection=e,e&&this.reload()},selectedHeaders:function(e,t){if(JSON.stringify(e)!==JSON.stringify(t)&&(localStorage["fields_"+this.internalSection]=JSON.stringify(Object.values(e))),this.data.fields){let t=[];for(const[,a]of Object.entries(this.data.fields))e.includes(a.column)&&t.push(a);this.$emit("changeFields",t)}},headers:function(e){let t=localStorage["fields_"+this.internalSection],a=t?JSON.parse(t):e.map((e=>e.key)),l=e.map((e=>e.key));a=a.filter((e=>l.includes(e))),this.selectedHeaders=a}},computed:{activeHeaders:function(){let e=[];return this.data.fields&&Object.values(this.data.fields).forEach((t=>{this.selectedHeaders.includes(t.column)&&e.push({title:this.formatString(t.column),value:t.column,sortable:!0})})),e},isSortable:function(){let e=!1;return this.data.fields&&Object.values(this.data.fields).forEach((t=>{"position"===t.type&&(e=!0)})),e}},created(){this.internalSection=this.section?this.section:this.$route.params.section,this.apiRoot=x.A.getApiRoot()}};const G=(0,H.A)(z,[["render",V]]);var Y=G}}]);
//# sourceMappingURL=794.8ecc158c.js.map