"use strict";(self["webpackChunkshiftadmin"]=self["webpackChunkshiftadmin"]||[]).push([[793],{71793:function(e,t,l){l.r(t),l.d(t,{default:function(){return B}});var a=l(56768),i=l(24232),o=l(45130),n=l(31969),s=l(13892),d=l(4189),u=l(93745),r=l(30697),m=l(91606),c=l(40276),b=l(20396),p=l(91772),f=l(418),h=l(95272),k=l(22162),y=l(32421),g=l(41720),v=l(79669),F=l(69915),D=l(57254),V=l(4913),_=l(97505),I=l(20552),C=l(49930),W=l(20105),w=l(51146),x=l(10381),T=l(76686),O=l(43948),S=l(53740);const U={class:"w-100"},X={key:2},A={key:3},Q={key:1},$=(0,a.Lk)("br",null,null,-1),M={key:0},E={key:2},j={key:3},K={key:4},N=(0,a.Lk)("div",{class:"text-h5 text-medium-emphasis ps-2"}," Subsection ",-1);function L(e,t,l,L,J,P){const q=(0,a.g2)("draggable");return(0,a.uX)(),(0,a.CE)("div",U,[(0,a.bF)(x.h,{modelValue:e.tab,"onUpdate:modelValue":t[0]||(t[0]=t=>e.tab=t)},{default:(0,a.k6)((()=>[(0,a.bF)(T.U,{value:"tables"},{default:(0,a.k6)((()=>[(0,a.eW)("Tables")])),_:1}),(0,a.bF)(T.U,{value:"menu"},{default:(0,a.k6)((()=>[(0,a.eW)("Menu")])),_:1}),(0,a.bF)(T.U,{value:"options"},{default:(0,a.k6)((()=>[(0,a.eW)("Options")])),_:1}),(0,a.bF)(T.U,{value:"general"},{default:(0,a.k6)((()=>[(0,a.eW)("General")])),_:1})])),_:1},8,["modelValue"]),(0,a.bF)(d.J,{loading:e.loading},{default:(0,a.k6)((()=>[e.error?((0,a.uX)(),(0,a.Wv)(n.l,{key:0,type:"error",text:e.error},null,8,["text"])):(0,a.Q3)("",!0),(0,a.bF)(u.S,null,{default:(0,a.k6)((()=>["tables"!==e.tab?((0,a.uX)(),(0,a.Wv)(s.D,{key:0,color:"primary",variant:"flat",onClick:P.save,disabled:!e.dirty},{default:(0,a.k6)((()=>[(0,a.eW)("Save")])),_:1},8,["onClick","disabled"])):(0,a.Q3)("",!0),"tables"===e.tab?((0,a.uX)(),(0,a.Wv)(s.D,{key:1,icon:"mdi-plus",onClick:t[1]||(t[1]=t=>{e.table={},e.tableDialog=!0})})):(0,a.Q3)("",!0),"menu"===e.tab?((0,a.uX)(),(0,a.CE)("span",X,[(0,a.bF)(s.D,{icon:"mdi-plus",onClick:t[2]||(t[2]=t=>{e.menuItem={type:"Table"},e.menuDialog=!0})}),(0,a.bF)(s.D,{icon:"mdi-sort",title:"Sort",onClick:t[3]||(t[3]=t=>P.openSectionSortable(e.data.vars.menu))})])):(0,a.Q3)("",!0),"options"===e.tab?((0,a.uX)(),(0,a.CE)("span",A,[(0,a.bF)(s.D,{icon:"mdi-plus",onClick:t[4]||(t[4]=t=>{e.option={name:""},e.optionDialog=!0})})])):(0,a.Q3)("",!0)])),_:1}),"tables"===e.tab?((0,a.uX)(),(0,a.CE)("div",Q,[(0,a.bF)(r.O,null,{default:(0,a.k6)((()=>[(0,a.eW)(" These are the database tables which can be used to create administratable sections in the CMS."),$,(0,a.eW)(" Any changes will instantly affect the database so make sure that you have a back-up. ")])),_:1}),(0,a.bF)(f.$t,{style:{"max-width":"600px"}},{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(P.filteredTables,((l,n)=>((0,a.uX)(),(0,a.Wv)(h.c,{modelValue:e.panel,"onUpdate:modelValue":t[5]||(t[5]=t=>e.panel=t),multiple:"",key:n},{default:(0,a.k6)((()=>[(0,a.bF)(k.w,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(n),1),(0,a.bF)(g.h),(0,a.bF)(s.D,{icon:"mdi-plus",onClick:(0,o.D$)((t=>{e.field={name:"",type:"text",table:n},e.fieldDialog=!0}),["stop"])},null,8,["onClick"]),(0,a.bF)(s.D,{icon:"mdi-sort",title:"Sort",onClick:(0,o.D$)((e=>P.openSortable(n,l)),["stop"])},null,8,["onClick"]),(0,a.bF)(s.D,{icon:"mdi-pencil",onClick:(0,o.D$)((t=>{e.table={id:n,name:n},e.tableDialog=!0}),["stop"])},null,8,["onClick"]),(0,a.bF)(s.D,{icon:"mdi-delete",onClick:(0,o.D$)((e=>P.deleteTable(n)),["stop"]),disabled:["users"].includes(n)},null,8,["onClick","disabled"])])),_:2},1024),(0,a.bF)(y.T,null,{default:(0,a.k6)((()=>[(0,a.bF)(d.J,null,{default:(0,a.k6)((()=>[(0,a.bF)(F.x8,null,{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(l,((t,l)=>((0,a.uX)(),(0,a.Wv)(D.g,{key:l,value:l},{append:(0,a.k6)((()=>[(0,a.bF)(s.D,{icon:"mdi-pencil",onClick:(0,o.D$)((l=>{e.field={...t},e.field.id=t.name,e.field.table=n,e.field.required=t.required>0,e.fieldDialog=!0}),["stop"])},null,8,["onClick"]),(0,a.bF)(s.D,{icon:"mdi-delete",onClick:(0,o.D$)((e=>P.deleteField(n,t.name)),["stop"])},null,8,["onClick"])])),default:(0,a.k6)((()=>[(0,a.bF)(V.U,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(t.name),1),t.required>0?((0,a.uX)(),(0,a.CE)("strong",M,"*")):(0,a.Q3)("",!0)])),_:2},1024),(0,a.bF)(_.w,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(t.type),1)])),_:2},1024)])),_:2},1032,["value"])))),128))])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["modelValue"])))),128))])),_:1})])):(0,a.Q3)("",!0),"menu"===e.tab?((0,a.uX)(),(0,a.CE)("div",E,[(0,a.bF)(r.O,null,{default:(0,a.k6)((()=>[(0,a.eW)(" Manage the admin menu and define subsections. ")])),_:1}),(0,a.bF)(f.$t,{modelValue:e.panel,"onUpdate:modelValue":t[6]||(t[6]=t=>e.panel=t),multiple:"",style:{"max-width":"600px"}},{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.data.vars.menu,((t,l)=>((0,a.uX)(),(0,a.Wv)(h.c,{key:l,value:l},{default:(0,a.k6)((()=>[(0,a.bF)(k.w,null,{default:(0,a.k6)((()=>[(0,a.bF)(v.w,{icon:t.icon?t.icon:"mdi-minus",class:"mr-3"},null,8,["icon"]),(0,a.eW)(" "+(0,i.v_)(t.title)+" ",1),(0,a.bF)(g.h),"Table"===P.getMenuItemType(t)?((0,a.uX)(),(0,a.Wv)(s.D,{key:0,icon:"mdi-plus",onClick:(0,o.D$)((l=>{e.subsection={section:t.title.toLowerCase()},e.subsectionDialog=!0}),["stop"])},null,8,["onClick"])):(0,a.Q3)("",!0),"Table"===P.getMenuItemType(t)?((0,a.uX)(),(0,a.Wv)(s.D,{key:1,icon:"mdi-sort",title:"Sort",onClick:(0,o.D$)((l=>P.openSectionSortable(e.data.vars.subsections[t.title.toLowerCase()])),["stop"]),disabled:!e.data.vars.subsections[t.title.toLowerCase()]?.length},null,8,["onClick","disabled"])):(0,a.Q3)("",!0),"Folder"===P.getMenuItemType(t)?((0,a.uX)(),(0,a.Wv)(s.D,{key:2,icon:"mdi-plus",onClick:(0,o.D$)((l=>{e.menuItem={parent:t.title,newParent:t.title,type:"Table"},e.menuDialog=!0}),["stop"])},null,8,["onClick"])):(0,a.Q3)("",!0),"Folder"===P.getMenuItemType(t)?((0,a.uX)(),(0,a.Wv)(s.D,{key:3,icon:"mdi-sort",title:"Sort",onClick:(0,o.D$)((e=>P.openSectionSortable(t.children)),["stop"]),disabled:!t.children?.length},null,8,["onClick","disabled"])):(0,a.Q3)("",!0),(0,a.bF)(s.D,{icon:"mdi-pencil",onClick:(0,o.D$)((a=>{e.menuItem={...t},e.menuItem.index=l,e.menuItem.type=P.getMenuItemType(t),e.menuDialog=!0,e.menuItem.newParent=e.menuItem.parent}),["stop"])},null,8,["onClick"]),(0,a.bF)(s.D,{icon:"mdi-delete",onClick:(0,o.D$)((t=>P.deleteMenuItem(l,e.data.vars.menu)),["stop"])},null,8,["onClick"])])),_:2},1024),(0,a.bF)(y.T,null,{default:(0,a.k6)((()=>[(0,a.bF)(F.x8,{"max-width":"600"},{default:(0,a.k6)((()=>["Table"===P.getMenuItemType(t)&&e.data.vars.subsections?((0,a.uX)(!0),(0,a.CE)(a.FK,{key:0},(0,a.pI)(e.data.vars.subsections[t.title.toLowerCase()],((l,i)=>((0,a.uX)(),(0,a.Wv)(D.g,{key:i,title:l.title,"prepend-icon":l.icon?l.icon:"mdi-minus"},{append:(0,a.k6)((()=>[(0,a.bF)(s.D,{icon:"mdi-pencil",onClick:(0,o.D$)((a=>{e.subsection={...l},e.subsection.section=t.title.toLowerCase(),e.subsection.index=i,e.subsectionDialog=!0}),["stop"])},null,8,["onClick"]),(0,a.bF)(s.D,{icon:"mdi-delete",onClick:(0,o.D$)((e=>P.deleteSubsection(t.title.toLowerCase(),i)),["stop"])},null,8,["onClick"])])),_:2},1032,["title","prepend-icon"])))),128)):(0,a.Q3)("",!0),"Folder"===P.getMenuItemType(t)?((0,a.uX)(!0),(0,a.CE)(a.FK,{key:1},(0,a.pI)(t.children,((l,i)=>((0,a.uX)(),(0,a.Wv)(D.g,{key:i,title:l.title,"prepend-icon":l.icon?l.icon:"mdi-minus"},{append:(0,a.k6)((()=>[(0,a.bF)(s.D,{icon:"mdi-pencil",onClick:(0,o.D$)((a=>{e.menuItem={...l},e.menuItem.index=i,e.menuItem.type=P.getMenuItemType(l),e.menuItem.parent=t.title,e.menuItem.newParent=t.title,e.menuDialog=!0}),["stop"])},null,8,["onClick"]),(0,a.bF)(s.D,{icon:"mdi-delete",onClick:(0,o.D$)((e=>P.deleteMenuItem(i,t.children)),["stop"])},null,8,["onClick"])])),_:2},1032,["title","prepend-icon"])))),128)):(0,a.Q3)("",!0)])),_:2},1024)])),_:2},1024)])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue"])])):(0,a.Q3)("",!0),"options"===e.tab?((0,a.uX)(),(0,a.CE)("div",j,[(0,a.bF)(r.O,null,{default:(0,a.k6)((()=>[(0,a.eW)(' Options are used by "select" and "select multiple" fields. They can either be a list of values or rows from a table. ')])),_:1}),(0,a.bF)(F.x8,{"max-width":"600"},{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.data.vars.options,((e,t,l)=>((0,a.uX)(),(0,a.Wv)(D.g,{key:l,value:t,title:t},{append:(0,a.k6)((()=>[(0,a.bF)(s.D,{icon:"mdi-pencil",onClick:(0,o.D$)((e=>P.editOption(t)),["stop"])},null,8,["onClick"]),(0,a.bF)(s.D,{icon:"mdi-delete",onClick:(0,o.D$)((e=>P.deleteOption(t)),["stop"])},null,8,["onClick"])])),_:2},1032,["value","title"])))),128))])),_:1})])):(0,a.Q3)("",!0),"general"===e.tab?((0,a.uX)(),(0,a.CE)("div",K,[(0,a.bF)(r.O,null,{default:(0,a.k6)((()=>[(0,a.eW)(" Customise the look of the CMS and where automatic emails are sent from. ")])),_:1}),(0,a.bF)(O.W,{label:"From email",modelValue:e.data.from_email,"onUpdate:modelValue":t[7]||(t[7]=t=>e.data.from_email=t)},null,8,["modelValue"]),(0,a.bF)(O.W,{label:"Title",modelValue:e.data.vars.branding.title,"onUpdate:modelValue":t[8]||(t[8]=t=>e.data.vars.branding.title=t)},null,8,["modelValue"]),(0,a.bF)(O.W,{label:"Primary",modelValue:e.data.vars.branding.colors.primary,"onUpdate:modelValue":t[9]||(t[9]=t=>e.data.vars.branding.colors.primary=t),type:"color"},null,8,["modelValue"]),(0,a.bF)(O.W,{label:"Secondary",modelValue:e.data.vars.branding.colors.secondary,"onUpdate:modelValue":t[10]||(t[10]=t=>e.data.vars.branding.colors.secondary=t),type:"color"},null,8,["modelValue"])])):(0,a.Q3)("",!0)])),_:1},8,["loading"]),(0,a.bF)(p.p,{modelValue:e.tableDialog,"onUpdate:modelValue":t[12]||(t[12]=t=>e.tableDialog=t),"max-width":"600"},{default:(0,a.k6)((()=>[(0,a.bF)(d.J,{title:"Table"},{default:(0,a.k6)((()=>[(0,a.bF)(r.O,null,{default:(0,a.k6)((()=>[e.error?((0,a.uX)(),(0,a.Wv)(n.l,{key:0,type:"error",text:e.error},null,8,["text"])):(0,a.Q3)("",!0),(0,a.bF)(O.W,{label:"Name",modelValue:e.table.name,"onUpdate:modelValue":t[11]||(t[11]=t=>e.table.name=t),autofocus:""},null,8,["modelValue"])])),_:1}),(0,a.bF)(u.S,null,{default:(0,a.k6)((()=>[(0,a.bF)(s.D,{variant:"flat",color:"primary",disabled:""===e.table.name,onClick:P.saveTable},{default:(0,a.k6)((()=>[(0,a.eW)("Save")])),_:1},8,["disabled","onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,a.bF)(p.p,{modelValue:e.fieldDialog,"onUpdate:modelValue":t[17]||(t[17]=t=>e.fieldDialog=t),"max-width":"600"},{default:(0,a.k6)((()=>[(0,a.bF)(d.J,{title:"Field"},{default:(0,a.k6)((()=>[(0,a.bF)(r.O,null,{default:(0,a.k6)((()=>[e.error?((0,a.uX)(),(0,a.Wv)(n.l,{key:0,type:"error",text:e.error},null,8,["text"])):(0,a.Q3)("",!0),(0,a.bF)(O.W,{label:"Name",modelValue:e.field.name,"onUpdate:modelValue":t[13]||(t[13]=t=>e.field.name=t),autofocus:""},null,8,["modelValue"]),(0,a.bF)(W.d4,{label:"Field",modelValue:e.field.type,"onUpdate:modelValue":t[14]||(t[14]=t=>e.field.type=t),items:e.fieldTypes},null,8,["modelValue","items"]),(0,a.bF)(O.W,{label:"Label",modelValue:e.field.label,"onUpdate:modelValue":t[15]||(t[15]=t=>e.field.label=t)},null,8,["modelValue"]),(0,a.bF)(c.a,{label:"Required",modelValue:e.field.required,"onUpdate:modelValue":t[16]||(t[16]=t=>e.field.required=t)},null,8,["modelValue"])])),_:1}),(0,a.bF)(u.S,null,{default:(0,a.k6)((()=>[(0,a.bF)(s.D,{variant:"flat",color:"primary",disabled:""===e.field.name,onClick:P.saveField},{default:(0,a.k6)((()=>[(0,a.eW)("Save")])),_:1},8,["disabled","onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,a.bF)(p.p,{modelValue:e.sortFieldsDialog,"onUpdate:modelValue":t[20]||(t[20]=t=>e.sortFieldsDialog=t),"max-width":"600",scrollable:""},{default:(0,a.k6)((()=>[(0,a.bF)(d.J,{title:"Sort Field Order"},{default:(0,a.k6)((()=>[(0,a.bF)(r.O,null,{default:(0,a.k6)((()=>[(0,a.bF)(q,{modelValue:e.sortOrder,"onUpdate:modelValue":t[18]||(t[18]=t=>e.sortOrder=t),group:"items",onStart:t[19]||(t[19]=t=>e.drag=!0),onEnd:P.moveField,"item-key":"name"},{item:(0,a.k6)((({element:e})=>[(0,a.bF)(w.i,{color:"primary",class:"ma-5 pa-5"},{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(e.name),1)])),_:2},1024)])),_:1},8,["modelValue","onEnd"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,a.bF)(p.p,{modelValue:e.sortSectionsDialog,"onUpdate:modelValue":t[22]||(t[22]=t=>e.sortSectionsDialog=t),"max-width":"600",scrollable:""},{default:(0,a.k6)((()=>[(0,a.bF)(d.J,{title:"Sort Section Order"},{default:(0,a.k6)((()=>[(0,a.bF)(r.O,null,{default:(0,a.k6)((()=>[(0,a.bF)(q,{list:e.sortOrder,group:"items","item-key":"",onEnd:t[21]||(t[21]=t=>e.dirty=!0)},{item:(0,a.k6)((({element:e})=>[(0,a.bF)(w.i,{color:"primary",class:"ma-5 pa-5"},{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(e.title?e.title:e),1)])),_:2},1024)])),_:1},8,["list"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,a.bF)(p.p,{modelValue:e.menuDialog,"onUpdate:modelValue":t[31]||(t[31]=t=>e.menuDialog=t),"max-width":"600"},{default:(0,a.k6)((()=>[(0,a.bF)(d.J,{title:"Menu item"},{default:(0,a.k6)((()=>[(0,a.bF)(r.O,null,{default:(0,a.k6)((()=>[e.error?((0,a.uX)(),(0,a.Wv)(n.l,{key:0,type:"error",text:e.error},null,8,["text"])):(0,a.Q3)("",!0),(0,a.bF)(x.h,{modelValue:e.menuItem.type,"onUpdate:modelValue":t[23]||(t[23]=t=>e.menuItem.type=t)},{default:(0,a.k6)((()=>[(0,a.bF)(T.U,{value:"Table",disabled:!isNaN(e.menuItem.index)},{default:(0,a.k6)((()=>[(0,a.eW)("Table")])),_:1},8,["disabled"]),(0,a.bF)(T.U,{value:"Custom",disabled:!isNaN(e.menuItem.index)},{default:(0,a.k6)((()=>[(0,a.eW)("Custom")])),_:1},8,["disabled"]),e.menuItem.parent?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(T.U,{key:0,value:"Folder",disabled:!isNaN(e.menuItem.index)},{default:(0,a.k6)((()=>[(0,a.eW)("Folder")])),_:1},8,["disabled"]))])),_:1},8,["modelValue"]),"Folder"!==e.menuItem.type?((0,a.uX)(),(0,a.Wv)(W.d4,{key:1,label:"Parent",modelValue:e.menuItem.newParent,"onUpdate:modelValue":t[24]||(t[24]=t=>e.menuItem.newParent=t),items:P.folders,clearable:""},null,8,["modelValue","items"])):(0,a.Q3)("",!0),"Table"===e.menuItem.type?((0,a.uX)(),(0,a.Wv)(b.A,{key:2,label:"Table",modelValue:e.menuItem.section,"onUpdate:modelValue":[t[25]||(t[25]=t=>e.menuItem.section=t),t[26]||(t[26]=t=>{e.menuItem.title=P.formatString(e.menuItem.section)})],items:P.getSections(),autofocus:""},null,8,["modelValue","items"])):"Custom"===e.menuItem.type?((0,a.uX)(),(0,a.Wv)(O.W,{key:3,label:"Link",modelValue:e.menuItem.to,"onUpdate:modelValue":t[27]||(t[27]=t=>e.menuItem.to=t),autofocus:""},null,8,["modelValue"])):(0,a.Q3)("",!0),"Custom"===e.menuItem.type?((0,a.uX)(),(0,a.Wv)(c.a,{key:4,label:"Open in new window",modelValue:e.menuItem.target_blank,"onUpdate:modelValue":t[28]||(t[28]=t=>e.menuItem.target_blank=t)},null,8,["modelValue"])):(0,a.Q3)("",!0),(0,a.bF)(O.W,{label:"Title",modelValue:e.menuItem.title,"onUpdate:modelValue":t[29]||(t[29]=t=>e.menuItem.title=t),autofocus:"Folder"===e.menuItem.type},null,8,["modelValue","autofocus"]),(0,a.bF)(O.W,{label:"Icon",modelValue:e.menuItem.icon,"onUpdate:modelValue":t[30]||(t[30]=t=>e.menuItem.icon=t),placeholder:"mdi-"},null,8,["modelValue"])])),_:1}),(0,a.bF)(u.S,null,{default:(0,a.k6)((()=>[(0,a.bF)(s.D,{variant:"flat",color:"primary",disabled:!P.isMenuValid,onClick:P.saveMenuItem},{default:(0,a.k6)((()=>[(0,a.eW)("OK")])),_:1},8,["disabled","onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,a.bF)(p.p,{modelValue:e.subsectionDialog,"onUpdate:modelValue":t[37]||(t[37]=t=>e.subsectionDialog=t),"max-width":"600",persistent:""},{default:(0,a.k6)((()=>[(0,a.bF)(d.J,null,{default:(0,a.k6)((()=>[(0,a.bF)(m.r,{class:"d-flex justify-space-between align-center"},{default:(0,a.k6)((()=>[N,(0,a.bF)(s.D,{icon:"mdi-close",onClick:t[32]||(t[32]=t=>{e.subsectionDialog=!1})})])),_:1}),(0,a.bF)(r.O,null,{default:(0,a.k6)((()=>[e.error?((0,a.uX)(),(0,a.Wv)(n.l,{key:0,type:"error",text:e.error},null,8,["text"])):(0,a.Q3)("",!0),(0,a.bF)(W.d4,{label:"Subsection",modelValue:e.subsection.subsection,"onUpdate:modelValue":[t[33]||(t[33]=t=>e.subsection.subsection=t),t[34]||(t[34]=t=>{e.subsection.title=P.formatString(e.subsection.subsection)})],items:Object.keys(P.filteredTables),autofocus:""},null,8,["modelValue","items"]),(0,a.bF)(O.W,{label:"Title",modelValue:e.subsection.title,"onUpdate:modelValue":t[35]||(t[35]=t=>e.subsection.title=t)},null,8,["modelValue"]),(0,a.bF)(O.W,{label:"Icon",modelValue:e.subsection.icon,"onUpdate:modelValue":t[36]||(t[36]=t=>e.subsection.icon=t),placeholder:"mdi-"},null,8,["modelValue"])])),_:1}),(0,a.bF)(u.S,null,{default:(0,a.k6)((()=>[(0,a.bF)(s.D,{variant:"flat",color:"primary",disabled:""===e.subsection.section,onClick:P.saveSubsection},{default:(0,a.k6)((()=>[(0,a.eW)("OK")])),_:1},8,["disabled","onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,a.bF)(p.p,{modelValue:e.optionDialog,"onUpdate:modelValue":t[42]||(t[42]=t=>e.optionDialog=t),"max-width":"600"},{default:(0,a.k6)((()=>[(0,a.bF)(d.J,{title:"Option"},{default:(0,a.k6)((()=>[(0,a.bF)(r.O,null,{default:(0,a.k6)((()=>[e.error?((0,a.uX)(),(0,a.Wv)(n.l,{key:0,type:"error",text:e.error},null,8,["text"])):(0,a.Q3)("",!0),(0,a.bF)(b.A,{label:"Name",modelValue:e.option.name,"onUpdate:modelValue":t[38]||(t[38]=t=>e.option.name=t),autofocus:"",items:P.optionKeys},null,8,["modelValue","items"]),(0,a.bF)(C.$,{modelValue:e.option.type,"onUpdate:modelValue":t[39]||(t[39]=t=>e.option.type=t)},{default:(0,a.k6)((()=>[(0,a.bF)(I.i,{label:"Table",value:"table"}),(0,a.bF)(I.i,{label:"Options",value:"options"})])),_:1},8,["modelValue"]),"table"===e.option.type?((0,a.uX)(),(0,a.Wv)(W.d4,{key:1,label:"table",modelValue:e.option.options,"onUpdate:modelValue":t[40]||(t[40]=t=>e.option.options=t),items:Object.keys(P.filteredTables)},null,8,["modelValue","items"])):"options"===e.option.type?((0,a.uX)(),(0,a.Wv)(S.J,{key:2,label:"Options",modelValue:e.option.options,"onUpdate:modelValue":t[41]||(t[41]=t=>e.option.options=t)},null,8,["modelValue"])):(0,a.Q3)("",!0)])),_:1}),(0,a.bF)(u.S,null,{default:(0,a.k6)((()=>[(0,a.bF)(s.D,{variant:"flat",color:"primary",disabled:""===e.option.name,onClick:P.saveOption},{default:(0,a.k6)((()=>[(0,a.eW)("OK")])),_:1},8,["disabled","onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"])])}l(44114);var J=l(74300),P=l(61527),q=l.n(P),R=l(27274),G={components:{draggable:q()},beforeRouteLeave(e,t,l){if(!this.dirty||confirm("You have unsaved changes. Do you want to continue?"))return l()},props:{vars:null},data:function(){return{tab:"tables",panel:[],table:{},tableDialog:!1,field:{},fieldDialog:!1,data:{},error:"",loading:!1,fieldTypes:["checkbox","color","combo","coords","date","datetime","decimal","deleted","dob","editor","email","file","files","hidden","id","integer","ip","mobile","page_name","password","polygon","position","postcode","rating","read","select","select_multiple","select_parent","tel","text","textarea","time","timestamp","upload","uploads","url"],drag:!1,sortFieldsDialog:!1,sortTable:"",sortOrder:[],menuDialog:!1,menuItem:{},subsectionDialog:!1,subsection:{},optionDialog:!1,option:{},sortSectionsDialog:!1,dirty:!1,hideConfigTables:!0,configTables:["cms_activation","cms_filters","cms_login_attempts","cms_logs","cms_privileges","cms_reports","cms_trusted_devices","email_templates","files"]}},methods:{fetchData:async function(){const e=await J.A.get("config.php");e.data.error&&(this.error=e.data.error);let t=e.data;t.vars||(t.vars={}),t.vars.subsections||(t.vars.subsections={});for(let[a,i]of Object.entries(t.vars.subsections))i.forEach(((e,l)=>{"string"===typeof e&&(t.vars.subsections[a][l]={title:this.formatString(e),subsection:e})}));t.vars.branding||(t.vars.branding={}),t.vars.branding.colors&&!Array.isArray(t.vars.branding.colors)||(t.vars.branding.colors={}),this.data=t,await this.$nextTick();let l=t.vars?.branding?.title?t.vars.branding.title:"ADMIN";document.title=l+" | Configure",this.dirty=!1},save:async function(){this.error="",this.loading=!0;const e=await J.A.post("config.php?cmd=save",this.data);this.loading=!1,e.data.error?this.error=e.data.error:(await this.fetchData(),this.$emit("configUpdated"))},saveTable:async function(){this.error="",this.loading=!0;const e=await J.A.post("config.php?cmd=save_table",this.table);this.loading=!1,e.data.error?this.error=e.data.error:(this.tableDialog=!1,this.fetchData())},deleteTable:async function(e){if(!confirm("Drop table "+e))return;this.error="",this.loading=!0;const t=await J.A.post("config.php?cmd=delete_table",{table:e});this.loading=!1,t.data.error?this.error=t.data.error:this.fetchData()},saveField:async function(){this.error="",this.loading=!0;const e=await J.A.post("config.php?cmd=save_field",this.field);this.loading=!1,e.data.error?this.error=e.data.error:(this.fieldDialog=!1,this.fetchData())},deleteField:async function(e,t){if(!confirm("Drop field "+t+" from "+e))return;this.error="",this.loading=!0;const l=await J.A.post("config.php?cmd=delete_field",{table:e,field:t});this.loading=!1,l.data.error?this.error=l.data.error:this.fetchData()},openSortable:function(e,t){this.sortOrder=[...t],this.sortTable=e,this.sortFieldsDialog=!0},openSectionSortable:function(e){this.sortOrder=e,this.sortSectionsDialog=!0},moveField:async function(e){let t=this.sortOrder[e.newIndex].name,l=e.newIndex?this.sortOrder[e.newIndex-1].name:"";this.error="",this.loading=!0;const a=await J.A.post("config.php?cmd=move_field",{table:this.sortTable,field:t,after:l});this.loading=!1,a.data.error?this.error=a.data.error:this.fetchData()},saveMenuItem:function(){let e={title:this.menuItem.title,icon:this.menuItem.icon};"Folder"===this.menuItem.type?e.children=this.menuItem.children?this.menuItem.children:[]:"Table"===this.menuItem.type?e.section=this.menuItem.section:"Custom"===this.menuItem.type&&(e.to=this.menuItem.to,e.target_blank=this.menuItem.target_blank);let t=this.data.vars.menu;this.menuItem.parent&&(t=this.data.vars.menu.find((e=>e.title===this.menuItem.parent)).children),isNaN(this.menuItem.index)||this.menuItem.parent===this.menuItem.newParent||(t.splice(this.menuItem.index,1),t=this.menuItem.newParent?this.data.vars.menu.find((e=>e.title===this.menuItem.newParent)).children:this.data.vars.menu),Object.hasOwn(this.menuItem,"index")?t[this.menuItem.index]=e:t.push(e),this.menuDialog=!1,this.dirty=!0},deleteMenuItem:function(e,t){confirm("Delete menu item")&&(t.splice(e,1),this.dirty=!0)},saveSubsection:function(){this.subsection.subsection=this.subsection.subsection.replaceAll("_"," ");let e={...this.subsection};delete e.index,delete e.section,Object.hasOwn(this.subsection,"index")?this.data.vars.subsections[this.subsection.section][this.subsection.index]=e:(Array.isArray(this.data.vars.subsections[this.subsection.section])||(this.data.vars.subsections[this.subsection.section]=[]),this.data.vars.subsections[this.subsection.section].push(e)),this.subsectionDialog=!1,this.dirty=!0},deleteSubsection:function(e,t){confirm("Delete subsection")&&(this.data.vars.subsections[e].splice(t,1),this.dirty=!0)},renameObjKey:function(e,t,l){const a=Object.keys(e),i=a.reduce(((a,i)=>(i===t?a[l]=e[t]:a[i]=e[i],a)),{});return i},optionsToString:function(e){let t="";if(Array.isArray(e))e.forEach((function(e){t+=e+"\n"}));else if("object"===typeof e)for(let[l,a]of Object.entries(e))t+=l.replace("#","")+"="+a+"\n";else t=e;return t},editOption:function(e){this.option={name:e,index:e,type:"options"},"string"===typeof this.data.vars.options[e]&&(this.option.type="table"),this.option.options=this.optionsToString(this.data.vars.options[e]),this.optionDialog=!0,this.dirty=!0},saveOption:function(){let e;if("table"===this.option.type)e=this.option.options;else{let t=this.option.options.split("\n");e=t[0].includes("=")?{}:[],t.forEach((t=>{if(Array.isArray(e))e.push(t);else{let l=t.split("=");e[l[0]]=l[1]}}))}Object.hasOwn(this.option,"index")&&(this.data.vars.options=this.renameObjKey(this.data.vars.options,this.option.index,this.option.name)),this.data.vars.options[this.option.name]=e,this.optionDialog=!1,this.dirty=!0},deleteOption:function(e){confirm("Delete option")&&(delete this.data.vars.options[e],this.dirty=!0)},getMenuItemType:function(e){return Array.isArray(e.children)?"Folder":e.section?"Table":"Custom"},getSections:function(){return Object.keys(this.filteredTables).map((e=>e.replaceAll("_"," ")))},formatString:function(e){return R.A.formatString(e)}},computed:{isMenuValid:function(){return!(!this.menuItem.title||!this.menuItem.type)&&(!("Table"===this.menuItem.type&&!this.menuItem.section)&&!("Custom"===this.menuItem.type&&!this.menuItem.to))},menuTypes:function(){let e=["Table","Custom"];return this.menuItem.parent||e.push("Folder"),e},filteredTables:function(){let e={};if(!this.data.tables)return e;for(let[t,l]of Object.entries(this.data.tables))this.hideConfigTables&&this.configTables.includes(t)||(e[t]=l);return e},optionKeys:function(){let e=[];if(!this.data.tables)return e;for(let[,t]of Object.entries(this.data.tables))t.forEach((t=>{["select","multiple_select"].includes(t.type)&&!this.data.vars.options[t.name]&&e.push(t.name)}));return e},folders:function(){return this.data.vars.menu.filter((e=>Array.isArray(e.children)))}},watch:{vars:function(){this.fetchData()},data:{handler:function(){this.dirty=!0},deep:!0}},async mounted(){this.fetchData()}},Y=l(71241);const z=(0,Y.A)(G,[["render",L]]);var B=z}}]);
//# sourceMappingURL=793.d561c413.js.map